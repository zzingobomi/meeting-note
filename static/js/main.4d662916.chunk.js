(this["webpackJsonpmeeting-note"]=this["webpackJsonpmeeting-note"]||[]).push([[0],{209:function(e){e.exports=JSON.parse('{"common":{"ok":"\ud655\uc778","cancel":"\ucde8\uc18c","logout":"\ub85c\uadf8\uc544\uc6c3"},"auth":{"login_with_anony":"\uc775\uba85 \ub85c\uadf8\uc778","login_with_email":"\uc774\uba54\uc77c \ub85c\uadf8\uc778","login_with_google":"\uad6c\uae00 \ub85c\uadf8\uc778","login_with_facebook":"\ud398\uc774\uc2a4\ubd81 \ub85c\uadf8\uc778"},"auth_form":{"label_email":"\uc774\uba54\uc77c","label_password":"\ube44\ubc00\ubc88\ud638","sign_in":"\ub85c\uadf8\uc778","sign_up":"\ud68c\uc6d0\uac00\uc785","validation":{"enter_email":"\uc774\uba54\uc77c\uc744 \uc785\ub825\ud574 \uc8fc\uc138\uc694","valid_email":"\uc720\ud6a8\ud55c \uc774\uba54\uc77c\uc744 \uc785\ub825\ud574 \uc8fc\uc138\uc694","require_email":"\uc774\uba54\uc77c\uc740 \ud544\uc218 \ud56d\ubaa9\uc785\ub2c8\ub2e4","enter_password":"\ube44\ubc00\ubc88\ud638\ub97c \uc785\ub825\ud574 \uc8fc\uc138\uc694","valid_password":"6\uc790\ub9ac \uc774\uc0c1\uc758 \ube44\ubc00\ubc88\ud638\ub97c \uc785\ub825\ud574 \uc8fc\uc138\uc694","require_password":"\ube44\ubc00\ubc88\ud638\ub294 \ud544\uc218 \ud56d\ubaa9\uc785\ub2c8\ub2e4"}},"lobby":{"my_room_title":"\ub0b4 \ud68c\uc758\uc2e4","other_room_title":"\ub2e4\ub978 \ud68c\uc758\uc2e4","create_room":"\ud68c\uc758\uc2e4 \ucd94\uac00"},"room_info":{"entrance":"\uc785\uc7a5\ud558\uae30","delete_confirm":"\uc815\ub9d0 \ud68c\uc758\uc2e4\uc744 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?","delete":"\uc0ad\uc81c\ud558\uae30"},"media_info":{"select_camera_label":"Camera"},"create_room":{"roomname_label":"\ud68c\uc758\uc2e4 \uc774\ub984","nickname_label":"\ub2c9\ub124\uc784","create_room_label":"\ub9cc\ub4e4\uae30"},"prepare_room":{"nickname_label":"\ub2c9\ub124\uc784","entrance_room_label":"\uc785\uc7a5\ud558\uae30"},"room_submit":{"validation":{"enter_roomname":"\ud68c\uc758\uc2e4 \uc774\ub984\uc744 \uc785\ub825\ud574 \uc8fc\uc138\uc694","valid_roomname":"20\uc790\ub9ac \ubbf8\ub9cc\uc758 \ud68c\uc758\uc2e4 \uc774\ub984\uc744 \uc785\ub825\ud574 \uc8fc\uc138\uc694","require_roomname":"\ud68c\uc758\uc2e4 \uc774\ub984\uc740 \ud544\uc218 \ud56d\ubaa9\uc785\ub2c8\ub2e4","enter_nickname":"\ub2c9\ub124\uc784\uc744 \uc785\ub825\ud574 \uc8fc\uc138\uc694","valid_nickname":"20\uc790\ub9ac \ubbf8\ub9cc\uc758 \ub2c9\ub124\uc784\uc744 \uc785\ub825\ud574 \uc8fc\uc138\uc694","require_nickname":"\ub2c9\ub124\uc784\uc740 \ud544\uc218 \ud56d\ubaa9\uc785\ub2c8\ub2e4"}},"meeting_room":{"exit_confirm":"\uc815\ub9d0 \ud68c\uc758\ub97c \uc885\ub8cc\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"},"meetingroom_message":{"message_placeholder":"\uba54\uc138\uc9c0\ub97c \uc785\ub825\ud574 \uc8fc\uc138\uc694","message_button":"\uba54\uc138\uc9c0 \uc804\uc1a1","message_delete":"\uba54\uc138\uc9c0 \uc0ad\uc81c","message_delete_confirm":"\uc815\ub9d0 \uba54\uc138\uc9c0\ub97c \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?","validation":{"enter_message":"\uba54\uc138\uc9c0\ub97c \uc785\ub825\ud574 \uc8fc\uc138\uc694","valid_message":"100\uc790\ub9ac \ubbf8\ub9cc\uc758 \uba54\uc138\uc9c0\ub97c \uc785\ub825\ud574 \uc8fc\uc138\uc694","require_message":"\uba54\uc138\uc9c0\ub97c \uc785\ub825\ud574 \uc8fc\uc138\uc694"}},"wrapup":{"download_messages":"CSV \ud30c\uc77c\ub85c \ub0b4\ubcf4\ub0b4\uae30","goto_lobby":"\ub85c\ube44\ub85c \uac00\uae30"}}')},234:function(e,t,n){},341:function(e,t,n){},342:function(e,t,n){},343:function(e,t,n){},344:function(e,t,n){},345:function(e,t,n){},346:function(e,t,n){},347:function(e,t,n){},348:function(e,t,n){},353:function(e,t,n){},354:function(e,t,n){},355:function(e,t,n){},356:function(e,t,n){},357:function(e,t,n){},359:function(e,t,n){},360:function(e,t,n){},361:function(e,t,n){},362:function(e,t,n){},363:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),c=n(58),o=n.n(c),s=n(12),i=n(30),u=n(184),l=n(65),m=n(186),d=(Object(u.a)({apiKey:"AIzaSyB0n84bPHSynRhB1P_iWx22yKF0CLfGAKE",authDomain:"meeting-note-f1e22.firebaseapp.com",projectId:"meeting-note-f1e22",storageBucket:"meeting-note-f1e22.appspot.com",messagingSenderId:"682081837300",appId:"1:682081837300:web:857f83576a6d2127b43ea1"}),Object(l.d)()),j=Object(m.a)(),b=n(411),f=n(210),O=n(404),p=n(410),h=n(60),g=n.n(h),x=n(25),v=(n(234),n(2)),_=function(){var e=Object(p.a)(["page"]).t,t=Object(x.g)(),n=Object(i.c)((function(e){return e.loginedUser})),r=Object(a.useState)(null),c=Object(s.a)(r,2),o=c[0],u=c[1],l=Boolean(o),m=function(e){u(e.currentTarget)},j=function(){u(null)};return Object(v.jsx)("header",{className:"header",children:Object(v.jsx)(b.a,{maxWidth:"lg",children:Object(v.jsxs)("div",{className:"header-container",children:[Object(v.jsx)("span",{className:"logo",onClick:function(){t.push("/")},children:"Meeting Note"}),Object(v.jsx)(f.a,{id:"basic-menu",anchorEl:o,open:l,onClose:j,MenuListProps:{"aria-labelledby":"basic-button"},children:Object(v.jsx)(O.a,{onClick:function(){j(),d.signOut()},children:e("page:common:logout")})}),n?Object(v.jsx)(v.Fragment,{children:n.photoURL?Object(v.jsxs)("div",{className:"user-info",children:[Object(v.jsx)("span",{children:n.displayName}),Object(v.jsx)("img",{src:n.photoURL,"aria-controls":"basic-menu","aria-haspopup":"true","aria-expanded":l?"true":void 0,onClick:m})]}):Object(v.jsx)(g.a,{className:"anony","aria-controls":"basic-menu","aria-haspopup":"true","aria-expanded":l?"true":void 0,onClick:m})}):Object(v.jsx)(v.Fragment,{})]})})})},w=n(142),N=n(0),k=n.n(N),S=n(4),y=n(413),C=n(405),I=n(417),T=n(74),E=n(41),D=(n(341),function(){var e=Object(p.a)(["page"]).t,t=Object(a.useState)(!1),n=Object(s.a)(t,2),r=n[0],c=n[1],o=Object(a.useState)(""),i=Object(s.a)(o,2),u=i[0],m=i[1],j=E.a({email:E.b(e("page:auth_form:validation:enter_email")).email(e("page:auth_form:validation:valid_email")).required(e("page:auth_form:validation:require_email")),password:E.b(e("page:auth_form:validation:enter_password")).min(6,e("page:auth_form:validation:valid_password")).required(e("page:auth_form:validation:require_password"))}),b=Object(T.a)({initialValues:{email:"",password:""},validationSchema:j,onSubmit:function(e){f(e.email,e.password)}}),f=function(){var e=Object(S.a)(k.a.mark((function e(t,n){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!r){e.next=7;break}return e.next=4,Object(l.c)(d,t,n);case 4:e.sent,e.next=10;break;case 7:return e.next=9,Object(l.f)(d,t,n);case 9:e.sent;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),m(e.t0.message);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t,n){return e.apply(this,arguments)}}();return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)(y.a,{className:"login-box",component:"form",noValidate:!0,autoComplete:"off",onSubmit:b.handleSubmit,children:[Object(v.jsx)(C.a,{name:"email",type:"email",label:e("page:auth_form:label_email"),variant:"standard",required:!0,value:b.values.email,onChange:b.handleChange,error:b.touched.email&&Boolean(b.errors.email),helperText:b.touched.email&&b.errors.email}),Object(v.jsx)("br",{}),Object(v.jsx)(C.a,{name:"password",type:"password",label:e("page:auth_form:label_password"),variant:"standard",required:!0,value:b.values.password,onChange:b.handleChange,error:b.touched.password&&Boolean(b.errors.password),helperText:b.touched.password&&b.errors.password}),Object(v.jsx)("br",{}),Object(v.jsx)(I.a,{type:"submit",variant:"contained",children:e(r?"page:auth_form:sign_up":"page:auth_form:sign_in")})]}),Object(v.jsx)(I.a,{className:"toggle-mode",onClick:function(){return c((function(e){return!e}))},children:e(r?"page:auth_form:sign_in":"page:auth_form:sign_up")}),Object(v.jsx)("div",{className:"error",children:u})]})}),A=n(197),R=n.n(A),M=n(198),U=n.n(M),q=(n(342),function(){var e=Object(p.a)(["page"]).t,t=Object(a.useState)(""),n=Object(s.a)(t,2),r=n[0],c=n[1],o=function(){var e=Object(S.a)(k.a.mark((function e(t){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(l.e)(d);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),c(e.t0.message);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),i=function(){var e=Object(S.a)(k.a.mark((function e(t,n){var a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"google"===n?a=new l.b:"facebook"===n?a=new l.a:console.log("check social login type"),e.prev=1,e.next=4,Object(l.g)(d,a);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),c(e.t0.message);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t,n){return e.apply(this,arguments)}}();return Object(v.jsxs)(b.a,{className:"container login-container",maxWidth:"xs",children:[Object(v.jsx)(D,{}),Object(v.jsxs)("div",{className:"social-container",children:[Object(v.jsx)(I.a,{className:"btn-anony",variant:"contained",onClick:o,startIcon:Object(v.jsx)(g.a,{}),children:e("page:auth:login_with_anony")}),Object(v.jsx)("br",{}),Object(v.jsx)(I.a,{className:"btn-google",variant:"contained",onClick:function(e){return i(e,"google")},startIcon:Object(v.jsx)(R.a,{style:{fill:"#d50f25"}}),children:e("page:auth:login_with_google")}),Object(v.jsx)("br",{}),Object(v.jsx)(I.a,{className:"btn-facebook",variant:"contained",onClick:function(e){return i(e,"facebook")},startIcon:Object(v.jsx)(U.a,{}),children:e("page:auth:login_with_facebook")}),Object(v.jsx)("div",{className:"error",children:r})]})]})}),P=n(40),F=n(26),H=n(409),L=n(418),V=n(419),B=n(420),W=n(38),J=n(123),z=n.n(J),X=(n(343),function(e){var t=e.roomObj,n=e.isOwner,a=Object(p.a)(["page"]).t,r=Object(x.g)(),c=function(){var e=Object(S.a)(k.a.mark((function e(){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(F.c)(Object(F.d)(j,"rooms/".concat(t.id)));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(v.jsx)(L.a,{onClick:function(){var e={entranceRoom:{id:t.id}};window.sessionStorage.setItem("sessionInfo",JSON.stringify(e)),r.push("/prepare")},children:Object(v.jsxs)(V.a,{children:[Object(v.jsx)("div",{className:"room-creator-time",children:W.DateTime.fromMillis(t.createdAt).toFormat("MM/dd HH:mm")}),Object(v.jsx)("div",{className:"room-name",children:t.name}),Object(v.jsxs)("div",{className:"room-creator-info",children:[Object(v.jsx)("span",{children:t.creatorNickName}),t.creatorPhotoUrl?Object(v.jsx)("img",{src:t.creatorPhotoUrl}):Object(v.jsx)(g.a,{className:"anony"}),n?Object(v.jsx)(B.a,{className:"btn-room-delete",onClick:function(e){e.stopPropagation(),window.confirm(a("page:room_info:delete_confirm"))&&c()},"aria-label":a("page:room_info:delete"),children:Object(v.jsx)(z.a,{})}):""]})]})})}),G=n(199),K=n.n(G),Y=(n(344),function(){var e=Object(p.a)(["page"]).t,t=Object(x.g)(),n=Object(i.c)((function(e){return e.loginedUser})),r=Object(a.useState)([]),c=Object(s.a)(r,2),o=c[0],u=c[1];Object(a.useEffect)((function(){l()}),[]);var l=function(){var e=Object(F.j)(Object(F.b)(j,"rooms"),Object(F.i)("createdAt","desc")),t=Object(F.h)(e,(function(e){var t=e.docs.map((function(e){return Object(P.a)({id:e.id},e.data())}));u(t)}));d.onAuthStateChanged((function(e){null===e&&t()}))};return Object(v.jsxs)(b.a,{className:"container lobby-container",maxWidth:"lg",children:[Object(v.jsx)("div",{className:"room-container-title",children:Object(v.jsx)("span",{children:e("page:lobby:my_room_title")})}),Object(v.jsxs)(H.a,{container:!0,spacing:3,justifyContent:"flex-start",alignItems:"stretch",children:[Object(v.jsx)(H.a,{item:!0,xs:12,sm:6,md:4,lg:3,children:Object(v.jsx)(L.a,{className:"btn-create-card",onClick:function(){t.push("/createroom")},children:Object(v.jsxs)(V.a,{className:"btn-create-content",children:[Object(v.jsx)(K.a,{className:"btn-create-icon"}),Object(v.jsx)("div",{className:"btn-create-label",children:e("page:lobby:create_room")})]})})}),o.filter((function(e){return e.creatorId===n.uid})).map((function(e){return Object(v.jsx)(H.a,{item:!0,xs:12,sm:6,md:4,lg:3,children:Object(v.jsx)(X,{roomObj:e,isOwner:!0},e.id)},e.id)}))]}),Object(v.jsx)("div",{className:"divider"}),Object(v.jsx)("div",{className:"room-container-title",children:Object(v.jsx)("span",{children:e("page:lobby:other_room_title")})}),Object(v.jsx)(H.a,{container:!0,spacing:3,children:o.filter((function(e){return e.creatorId!==n.uid})).map((function(e){return Object(v.jsx)(H.a,{item:!0,xs:12,sm:6,md:4,lg:3,children:Object(v.jsx)(X,{roomObj:e,isOwner:!1},e.id)},e.id)}))})]})}),Q=n(406),Z=n(403),$=n(416);var ee=function(e){var t=r.a.useState(0),n=Object(s.a)(t,2),a=n[0],c=n[1],o=r.a.useRef({}),i=r.a.useCallback((function(e){o.current.audioContext&&e.data.volume&&c(Math.round(200*e.data.volume))}),[]),u=r.a.useCallback((function(){if(o.current.node)try{o.current.node.disconnect()}catch(e){}if(o.current.source)try{o.current.source.disconnect()}catch(e){}o.current.node=null,o.current.source=null,o.current.audioContext=null,c(0)}),[]),l=r.a.useCallback(function(){var e=Object(S.a)(k.a.mark((function e(t){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o.current.audioContext&&u(),e.prev=1,o.current.audioContext=new AudioContext,e.next=5,o.current.audioContext.audioWorklet.addModule("./worklet/vumeter.js");case 5:if(o.current.audioContext){e.next=7;break}return e.abrupt("return");case 7:o.current.source=o.current.audioContext.createMediaStreamSource(t),o.current.node=new AudioWorkletNode(o.current.audioContext,"vumeter"),o.current.node.port.onmessage=i,o.current.source.connect(o.current.node).connect(o.current.audioContext.destination),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),u();case 16:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}(),[u,i]);return r.a.useEffect((function(){return c(0),e?(l(e),function(){u(e)}):function(){}}),[e,l,u]),a},te=(n(345),function(e){var t=e.volume,n=e.max,a=void 0===n?10:n,c=e.style,o=void 0===c?{}:c,s=r.a.useMemo((function(){for(var e=[],t=100/(2*a),n=0;n<a;n+=1)e.push(Object(v.jsx)("div",{className:"volumeMeterDivider",style:{left:"".concat((2*n+1)*t,"%"),width:"".concat(t,"%")}},n));return e}),[a]);return Object(v.jsxs)("div",{className:"volumeMeter",style:o,children:[Object(v.jsx)("div",{className:"volumeMeterBg"}),Object(v.jsx)("div",{className:"volumeMeterInner",style:{transform:"scaleX(".concat(Math.ceil(t*a/100)/a,")")}}),s]})});te.defaultProps={volume:null,max:0,style:null};var ne=r.a.memo(te,(function(e,t){return e.volume===t.volume&&e.max===t.max&&e.style===t.style})),ae=function(e){var t=e.stream,n=e.max,a=e.style,r=ee(t);return Object(v.jsx)(ne,{volume:r,max:n,style:a})};ae.defaultProps={stream:null,max:0,style:null};var re=r.a.memo(ae,(function(e,t){return e.stream===t.stream&&e.max===t.max&&e.style===t.style})),ce=(n(346),function(e){var t=e.stream,n=e.max,a=void 0===n?20:n,r=e.style,c=void 0===r?{}:r;return Object(v.jsx)(re,{stream:t,max:a,style:c})});ce.defaultProps={type:"AudioWorkletNode",stream:null,max:0,style:null};var oe=r.a.memo(ce,(function(e,t){return e.type===t.type&&e.stream===t.stream&&e.max===t.max&&e.style===t.style})),se=n(86),ie=n.n(se),ue=(n(347),function(e){var t=e.onCameraChange,n=Object(p.a)(["page"]).t,r=Object(a.useRef)(),c=Object(a.useState)(""),o=Object(s.a)(c,2),i=o[0],u=o[1],l=Object(a.useState)([]),m=Object(s.a)(l,2),d=m[0],j=m[1],b=Object(a.useState)(""),f=Object(s.a)(b,2),h=f[0],g=f[1],x=Object(a.useState)(null),_=Object(s.a)(x,2),w=_[0],N=_[1];Object(a.useEffect)((function(){C()}),[]),Object(a.useEffect)((function(){return function(){y()}}),[w]);var y=function(){w&&w.getTracks().forEach((function(e){e.stop()}))},C=function(){var e=Object(S.a)(k.a.mark((function e(t){var n,a,c;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={audio:!0,video:{facingMode:"user"}},a={audio:!0,video:{deviceId:{exact:t}}},e.prev=2,e.next=5,navigator.mediaDevices.getUserMedia(t?a:n);case 5:if(c=e.sent,r.current.srcObject=c,N(c),t){e.next=11;break}return e.next=11,I(c);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),u(e.t0.message);case 16:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=Object(S.a)(k.a.mark((function e(n){var a,r,c,o,s,i;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.enumerateDevices();case 3:for(a=e.sent,r=a.filter((function(e){return"videoinput"===e.kind})),c=r.map((function(e){return{value:e.deviceId,text:e.label}})),j(c),o=n.getTracks(),s=function(e){var n=o[e].getSettings().deviceId;r.forEach((function(e){n===e.deviceId&&(g(n),t(n))}))},i=0;i<o.length;i++)s(i);e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),u(e.t0.message);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(S.a)(k.a.mark((function e(n){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g(n.target.value),t(n.target.value),e.next=4,C(n.target.value);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(v.jsxs)("div",{className:"media-box",children:[Object(v.jsx)("video",{className:"video-preview",ref:r,autoPlay:!0,playsInline:!0}),Object(v.jsxs)("div",{className:"mic-wrapper",children:[Object(v.jsx)(ie.a,{}),Object(v.jsx)(oe,{className:"volume-meter",stream:w,max:40})]}),Object(v.jsxs)($.a,{className:"select-camera",variant:"standard",children:[Object(v.jsx)(Q.a,{id:"select-camera-label",children:n("page:media_info:select_camera_label")}),Object(v.jsx)(Z.a,{labelId:"select-camera-label",value:h,onChange:T,label:"Camera",children:d.map((function(e){return Object(v.jsx)(O.a,{value:e.value,children:e.text},e.value)}))})]}),Object(v.jsx)("div",{className:"error",children:i})]})}),le=(n(348),function(){var e=Object(p.a)(["page"]).t,t=Object(x.g)(),n=Object(i.c)((function(e){return e.loginedUser})),r=n.uid,c=n.displayName,o=n.photoURL,u=Object(a.useState)(""),l=Object(s.a)(u,2),m=l[0],d=l[1],f=Object(a.useState)(""),O=Object(s.a)(f,2),h=O[0],g=O[1],_=E.a({roomname:E.b(e("page:room_submit:validation:enter_roomname")).max(20,e("page:room_submit:validation:valid_roomname")).required(e("page:room_submit:validation:require_roomname")),nickname:E.b(e("page:room_submit:validation:enter_nickname")).max(20,e("page:room_submit:validation:valid_nickname")).required(e("page:room_submit:validation:require_nickname"))}),w=Object(T.a)({initialValues:{roomname:"",nickname:c},validationSchema:_,onSubmit:function(e){N(e.roomname,e.nickname)}}),N=function(){var e=Object(S.a)(k.a.mark((function e(n,a){var c,s,i;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c={name:n,creatorId:r,creatorNickName:a,creatorPhotoUrl:o,createdAt:W.DateTime.now().toMillis()},e.prev=1,e.next=4,Object(F.a)(Object(F.b)(j,"rooms"),c);case 4:s=e.sent,i={deviceId:h,nickName:a,entranceRoom:Object(P.a)({id:s.id},c)},window.sessionStorage.setItem("sessionInfo",JSON.stringify(i)),t.push("/meetingroom"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),d(e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,n){return e.apply(this,arguments)}}();return Object(v.jsxs)(b.a,{className:"container create-room-container",maxWidth:"xs",children:[Object(v.jsx)(ue,{onCameraChange:function(e){g(e)}}),Object(v.jsxs)(y.a,{className:"create-room-box",component:"form",noValidate:!0,autoComplete:"off",onSubmit:w.handleSubmit,children:[Object(v.jsx)(C.a,{name:"roomname",label:e("page:create_room:roomname_label"),variant:"standard",required:!0,value:w.values.roomname,onChange:w.handleChange,error:w.touched.roomname&&Boolean(w.errors.roomname),helperText:w.touched.roomname&&w.errors.roomname}),Object(v.jsx)("br",{}),Object(v.jsx)(C.a,{name:"nickname",label:e("page:create_room:nickname_label"),variant:"standard",required:!0,value:w.values.nickname,onChange:w.handleChange,error:w.touched.nickname&&Boolean(w.errors.nickname),helperText:w.touched.nickname&&w.errors.nickname}),Object(v.jsx)("br",{}),Object(v.jsx)(I.a,{type:"submit",variant:"contained",children:e("page:create_room:create_room_label")})]}),Object(v.jsx)("div",{className:"error",children:m})]})}),me=n(18),de=n(6),je=n(211),be=n(125),fe=n.n(be),Oe=(n(353),function(e){var t=e.nickName,n=e.stream,r=e.isOwner,c=Object(a.useRef)(null),o=Object(a.useState)(!1),i=Object(s.a)(o,2),u=i[0],l=i[1];Object(a.useEffect)((function(){c.current&&(c.current.srcObject=n)}),[n]);return Object(v.jsxs)("div",{className:"meeting-room-video",children:[Object(v.jsx)("video",{ref:c,muted:u,autoPlay:!0,playsInline:!0}),Object(v.jsx)("span",{className:"meeting-room-nickname",children:t||"\uc775\uba85\uc0ac\uc6a9\uc790"}),r?"":Object(v.jsx)("div",{className:"mic-icon-wrapper",onClick:function(){return l((function(e){return!e}))},children:u?Object(v.jsx)(fe.a,{className:"mic-iocn"}):Object(v.jsx)(ie.a,{className:"mic-iocn"})})]})}),pe=n(203),he=n.n(pe),ge=(n(354),function(e){var t=e.messageObj,n=e.isOwner,a=e.roomId,r=Object(p.a)(["page"]).t,c=function(){var e=Object(S.a)(k.a.mark((function e(){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(F.c)(Object(F.d)(j,"rooms/".concat(a,"/messages/").concat(t.id)));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(v.jsxs)("div",{className:"message-info-box",children:[t.creatorPhotoUrl?Object(v.jsx)("img",{src:t.creatorPhotoUrl}):Object(v.jsx)(g.a,{className:"anony"}),Object(v.jsx)("span",{className:"nickname",children:t.creatorNickName}),Object(v.jsx)("span",{className:"message",children:t.message}),n?Object(v.jsx)(B.a,{onClick:function(){window.confirm(r("page:meetingroom_message:message_delete_confirm"))&&c()},"aria-label":r("page:meetingroom_message:message_delete"),children:Object(v.jsx)(z.a,{})}):""]})}),xe=(n(355),function(e){var t=e.roomId,n=e.userId,r=e.userNickName,c=e.userPhotoUrl,o=Object(p.a)(["page"]).t,i=Object(a.useState)([]),u=Object(s.a)(i,2),l=u[0],m=u[1],b=Object(a.useState)(""),f=Object(s.a)(b,2),O=f[0],h=f[1],g=Object(a.useRef)(),x=E.a({message:E.b(o("page:meetingroom_message:validation:enter_message")).max(100,o("page:meetingroom_message:validation:valid_message")).required(o("page:meetingroom_message:validation:require_message"))}),_=Object(T.a)({initialValues:{message:""},validationSchema:x,onSubmit:function(e){N(e.message)}});Object(a.useEffect)((function(){w()}),[]);var w=function(){var e=Object(F.j)(Object(F.b)(j,"rooms",t,"messages"),Object(F.i)("createdAt","desc")),n=Object(F.h)(e,(function(e){var t=e.docs.map((function(e){return Object(P.a)({id:e.id},e.data())}));m(t),g.current&&(g.current.scrollTop=g.current.scrollHeight)}));d.onAuthStateChanged((function(e){null===e&&n()}))},N=function(){var e=Object(S.a)(k.a.mark((function e(a){var o;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o={message:a,createdAt:W.DateTime.now().toMillis(),creatorId:n,creatorNickName:r,creatorPhotoUrl:c},e.next=4,Object(F.a)(Object(F.b)(j,"rooms",t,"messages"),o);case 4:e.sent,_.handleReset(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),h(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("div",{ref:g,className:"messages-list",children:l.slice(0).reverse().map((function(e){return Object(v.jsx)(ge,{messageObj:e,isOwner:e.creatorId===n,roomId:t},e.id)}))}),Object(v.jsx)(y.a,{className:"message-box",component:"form",noValidate:!0,autoComplete:"off",onSubmit:_.handleSubmit,children:Object(v.jsx)(C.a,{autoFocus:!0,fullWidth:!0,name:"message",variant:"standard",placeholder:o("page:meetingroom_message:message_placeholder"),required:!0,value:_.values.message,onChange:_.handleChange,error:_.touched.message&&Boolean(_.errors.message),helperText:_.touched.message&&_.errors.message,InputProps:{endAdornment:Object(v.jsx)(B.a,{type:"submit",color:"primary","aria-label":o("page:meetingroom_message:message_button"),children:Object(v.jsx)(he.a,{})})}})}),Object(v.jsx)("div",{className:"error",children:O})]})}),ve=n(204),_e=n.n(ve),we=(n(356),function(){var e=Object(a.useState)(0),t=Object(s.a)(e,2),n=t[0],r=t[1],c=function(){r(window.pageYOffset)};return Object(a.useEffect)((function(){return window.addEventListener("scroll",c),function(){window.removeEventListener("scroll",c)}})),{scrollY:n}}),Ne=function(){var e,t,n,r=Object(p.a)(["page"]).t,c=Object(i.c)((function(e){return e.loginedUser})),o=JSON.parse(window.sessionStorage.getItem("sessionInfo")),u=Object(x.g)(),l=Object(a.useState)(""),m=Object(s.a)(l,2),d=m[0],j=m[1],f=Object(a.useState)(o.deviceId),O=Object(s.a)(f,2),h=O[0],g=(O[1],Object(a.useState)(o.nickName)),_=Object(s.a)(g,2),w=_[0],N=(_[1],Object(a.useState)(o.entranceRoom)),y=Object(s.a)(N,2),C=y[0],I=(y[1],Object(a.useState)(null)),T=Object(s.a)(I,2),E=T[0],D=T[1],A=Object(a.useState)(),R=Object(s.a)(A,2),M=(R[0],R[1]),U=Object(a.useState)([]),q=Object(s.a)(U,2),F=q[0],H=q[1],L=Object(a.useState)(!1),V=Object(s.a)(L,2),B=V[0],W=V[1],J=Object(a.useState)(!0),z=Object(s.a)(J,2),X=z[0],G=z[1],K=Object(a.useRef)();we().scrollY;Object(a.useEffect)((function(){return window.addEventListener("resize",ne),ne(),Y(),function(){window.removeEventListener("resize",ne),Q()}}),[]),Object(a.useEffect)((function(){return function(){Z()}}),[E]),Object(a.useEffect)((function(){ne()}),[F]);var Y=function(){var e=Object(S.a)(k.a.mark((function e(){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$(h);case 2:ee();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Q=function(){t&&t.disconnect()},Z=function(){E&&E.getTracks().forEach((function(e){e.stop()}))},$=function(){var t=Object(S.a)(k.a.mark((function t(n){var a,r;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={audio:!0,video:{facingMode:"user"}},r={audio:!0,video:{deviceId:{exact:n}}},t.prev=2,t.next=5,navigator.mediaDevices.getUserMedia(n?r:a);case 5:e=t.sent,D(e),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(2),j(t.t0.message);case 12:case"end":return t.stop()}}),t,null,[[2,9]])})));return function(e){return t.apply(this,arguments)}}(),ee=function(){console.log("handleSocket"),(t=Object(je.a)("https://node.zzingobomi.synology.me")).on("sayhello",(function(e){console.log("socket connected")})),t.emit("join_room",{room:C.id,nickName:w}),t.on("all_users",(function(a){var r=a.length;console.log("allUsers count: ",a.length);for(var c=function(r){te(a[r].id,a[r].email,t,e);var c=n[a[r].id];c&&c.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0}).then((function(e){console.log("create offer success"),c.setLocalDescription(new RTCSessionDescription(e)),t.emit("offer",{sdp:e,offerSendID:t.id,offerSendNickName:w,offerReceiveID:a[r].id})})).catch((function(e){console.log(e)}))},o=0;o<r;o++)c(o)})),t.on("getOffer",(function(a){console.log("getOffer"),te(a.offerSendID,a.offerSendNickName,t,e);var r=n[a.offerSendID];r&&r.setRemoteDescription(new RTCSessionDescription(a.sdp)).then((function(){console.log("answer set remote description success"),r.createAnswer({offerToReceiveVideo:!0,offerToReceiveAudio:!0}).then((function(e){console.log("create answer success"),r.setLocalDescription(new RTCSessionDescription(e)),t.emit("answer",{sdp:e,answerSendID:t.id,answerReceiveID:a.offerSendID})})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}))})),t.on("getAnswer",(function(e){console.log("getAnswer");var t=n[e.answerSendID];t&&t.setRemoteDescription(new RTCSessionDescription(e.sdp))})),t.on("getCandidate",(function(e){console.log("getCandidate");var t=n[e.candidateSendID];t&&t.addIceCandidate(new RTCIceCandidate(e.candidate)).then((function(){console.log("candidate add success")}))})),t.on("user_exit",(function(e){console.log("user_exit"),n[e.id].close(),delete n[e.id],H((function(t){return t.filter((function(t){return t.id!==e.id}))}))})),M(t)},te=function(e,t,a,r){var c=new RTCPeerConnection({iceServers:[{urls:["stun:stun.l.google.com:19302","stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302","stun:stun3.l.google.com:19302","stun:stun4.l.google.com:19302"]}]});return n=Object(P.a)(Object(P.a)({},n),{},Object(de.a)({},e,c)),c.onicecandidate=function(t){t.candidate&&(console.log("onicecandidate"),a.emit("candidate",{candidate:t.candidate,candidateSendID:a.id,candidateReceiveID:e}))},c.oniceconnectionstatechange=function(e){console.log(e)},c.ontrack=function(n){console.log("ontrack success"),H((function(t){return t.filter((function(t){return t.id!==e}))})),H((function(a){return[].concat(Object(me.a)(a),[{id:e,nickName:t,stream:n.streams[0]}])}))},r?(console.log("localStream add"),r.getTracks().forEach((function(e){c.addTrack(e,r)}))):console.log("no local stream"),c},ne=function(){ae()>1?G(!1):G(!0)},ae=function(){var e=Array.from(K.current.children),t=e[0].offsetTop,n=e.findIndex((function(e){return e.offsetTop>t}));return-1===n?e.length:n};return Object(v.jsxs)(b.a,{className:"container meeting-room-container",maxWidth:"md",children:[Object(v.jsxs)("div",{ref:K,className:"video-wrapper",children:[Object(v.jsx)(Oe,{nickName:w,stream:E,isOwner:"true"}),F.map((function(e,t){return Object(v.jsx)(Oe,{nickName:e.nickName,stream:e.stream},t)}))]}),Object(v.jsx)("div",{className:"messages-wrapper "+(X?"small":"large"),children:Object(v.jsx)("div",{className:"messages-box",children:Object(v.jsx)(xe,{roomId:C.id,userId:c.uid,userNickName:w,userPhotoUrl:c.photoURL})})}),Object(v.jsxs)("div",{className:"button-wrapper",children:[Object(v.jsx)("div",{className:"mute",onClick:function(){E.getAudioTracks().forEach((function(e){return e.enabled=!e.enabled})),W((function(e){return!e}))},children:B?Object(v.jsx)(fe.a,{}):Object(v.jsx)(ie.a,{})}),Object(v.jsx)("div",{className:"exit",onClick:function(){window.confirm(r("page:meeting_room:exit_confirm"))&&u.push("/wrapup")},children:Object(v.jsx)(_e.a,{})})]}),Object(v.jsx)("div",{className:"error",children:d})]})},ke=(n(357),function(){var e=Object(p.a)(["page"]).t,t=Object(x.g)(),n=Object(i.c)((function(e){return e.loginedUser})),r=(n.uid,n.displayName),c=Object(a.useState)(""),o=Object(s.a)(c,2),u=o[0],l=o[1],m=Object(a.useState)({}),d=Object(s.a)(m,2),f=d[0],O=d[1],h=Object(a.useState)(""),_=Object(s.a)(h,2),w=_[0],N=(_[1],Object(a.useState)("")),D=Object(s.a)(N,2),A=D[0],R=D[1],M=E.a({nickname:E.b(e("page:room_submit:validation:enter_nickname")).max(20,e("page:room_submit:validation:valid_nickname")).required(e("page:room_submit:validation:require_nickname"))}),U=Object(T.a)({initialValues:{nickname:r||""},validationSchema:M,onSubmit:function(e){H(e.nickname)}});Object(a.useEffect)((function(){q()}),[]);var q=function(){var e=Object(S.a)(k.a.mark((function e(){var t,n,a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=JSON.parse(window.sessionStorage.getItem("sessionInfo")),l(t.entranceRoom.id),n=Object(F.d)(j,"rooms",t.entranceRoom.id),e.next=5,Object(F.e)(n);case 5:(a=e.sent).exists()?O(a.data()):console.log("No such document!");case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H=function(){var e=Object(S.a)(k.a.mark((function e(n){var a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a={deviceId:A,nickName:n,entranceRoom:Object(P.a)({id:u},f)},window.sessionStorage.setItem("sessionInfo",JSON.stringify(a)),t.push("/meetingroom");case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(v.jsxs)(b.a,{className:"container prepare-room-container",maxWidth:"xs",children:[Object(v.jsx)(ue,{onCameraChange:function(e){R(e)}}),Object(v.jsxs)(y.a,{className:"prepare-room-box",component:"form",noValidate:!0,autoComplete:"off",onSubmit:U.handleSubmit,children:[Object(v.jsx)(C.a,{name:"nickname",label:e("page:prepare_room:nickname_label"),variant:"standard",required:!0,value:U.values.nickname,onChange:U.handleChange,error:U.touched.nickname&&Boolean(U.errors.nickname),helperText:U.touched.nickname&&U.errors.nickname}),Object(v.jsx)("br",{}),Object(v.jsxs)("div",{className:"prepare-room-info",children:[Object(v.jsx)("div",{className:"info-item prepare-room-name",children:Object(v.jsx)("span",{children:f.name})}),Object(v.jsxs)("div",{className:"info-item prepare-room-creator",children:[Object(v.jsx)("span",{children:f.creatorNickName}),f.creatorPhotoUrl?Object(v.jsx)("img",{className:"creator-icon",src:f.creatorPhotoUrl}):Object(v.jsx)(g.a,{className:"anony creator-icon"})]}),Object(v.jsx)("div",{className:"info-item prepare-room-time",children:W.DateTime.fromMillis(Number(f.createdAt)).toFormat("MM/dd HH:mm")})]}),Object(v.jsx)("br",{}),Object(v.jsx)(I.a,{type:"submit",variant:"contained",children:e("page:prepare_room:entrance_room_label")})]}),Object(v.jsx)("div",{className:"error",children:w})]})}),Se=n(206),ye=n.n(Se),Ce=n(205),Ie=n.n(Ce),Te=(n(359),function(){var e=Object(p.a)(["page"]).t,t=Object(x.g)(),n=Object(i.c)((function(e){return e.loginedUser})),r=JSON.parse(window.sessionStorage.getItem("sessionInfo")),c=Object(a.useState)(""),o=Object(s.a)(c,2),u=(o[0],o[1]),l=Object(a.useState)(""),m=Object(s.a)(l,2),d=m[0],f=m[1],O=Object(a.useState)(""),h=Object(s.a)(O,2),g=h[0],_=h[1],w=Object(a.useState)(""),N=Object(s.a)(w,2),y=N[0],C=N[1],T=Object(a.useState)([]),E=Object(s.a)(T,2),D=E[0],A=E[1];Object(a.useEffect)((function(){R(),M()}),[]);var R=function(){var e=Object(S.a)(k.a.mark((function e(){var t,n,a,c;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object(F.d)(j,"rooms",r.entranceRoom.id),e.next=3,Object(F.e)(t);case 3:(n=e.sent).exists()?(a=W.DateTime.now().diff(W.DateTime.fromMillis(Number(n.data().createdAt))),c=a.toFormat("dd : hh : mm : ss").replace(/^[0 : ]+(?=\d[\d : ]{3})/,""),_(c),f(W.DateTime.fromMillis(Number(n.data().createdAt)).toFormat("MM/dd HH:mm")),C(n.data().name)):u("No such rooms");case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=Object(S.a)(k.a.mark((function e(){var t,n,a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("getMessages"),t=Object(F.j)(Object(F.b)(j,"rooms",r.entranceRoom.id,"messages"),Object(F.i)("createdAt","asc")),e.next=4,Object(F.f)(t);case 4:n=e.sent,a=[],n.forEach((function(e){a.push({nickName:e.data().creatorNickName,message:e.data().message,time:W.DateTime.fromMillis(Number(e.data().createdAt)).toFormat("MM/dd HH:mm")})})),A(a);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(v.jsx)(b.a,{className:"container wrapup-container",maxWidth:"xs",children:Object(v.jsxs)("div",{className:"wrapup-box",children:[Object(v.jsx)(ye.a,{className:"run-icon"}),Object(v.jsx)("div",{className:"timeline",children:Object(v.jsx)("div",{className:"line"})}),Object(v.jsxs)("div",{className:"time-info",children:[Object(v.jsx)("span",{className:"start-time",children:d}),Object(v.jsx)("span",{className:"end-time",children:W.DateTime.now().toFormat("MM/dd HH:mm")})]}),Object(v.jsx)("span",{className:"duration",children:g}),n.isAnonymous?"":Object(v.jsx)(v.Fragment,{children:Object(v.jsx)(Ie.a,{className:"btn_export_csv",filename:y+".csv",data:D,children:e("page:wrapup:download_messages")})}),Object(v.jsx)(I.a,{onClick:function(){t.push("/lobby")},children:e("page:wrapup:goto_lobby")})]})})}),Ee=(n(360),function(){return Object(v.jsxs)("div",{className:"not-found",children:[Object(v.jsx)("div",{className:"error-code",children:"404"}),Object(v.jsx)("div",{className:"desc",children:"Not Found"})]})}),De=function(e){var t=[];return Ae(t,e.children),r.a.createElement.apply(r.a,[x.d,null].concat(t))};function Ae(e,t){r.a.Children.forEach(t,(function(t){r.a.isValidElement(t)&&(t.type===a.Fragment?Ae(e,t.props.children):e.push(t))}))}var Re=function(){var e=Object(i.c)((function(e){return e.loginedUser}));return console.log("AppRouter"),Object(v.jsxs)(w.a,{basename:"/meeting-note",children:[Object(v.jsx)(_,{}),Object(v.jsx)(De,{children:e?Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(x.b,{exact:!0,path:"/",children:Object(v.jsx)(x.a,{to:"/lobby"})}),Object(v.jsx)(x.b,{exact:!0,path:"/lobby",children:Object(v.jsx)(Y,{})}),Object(v.jsx)(x.b,{exact:!0,path:"/createroom",children:Object(v.jsx)(le,{})}),Object(v.jsx)(x.b,{exact:!0,path:"/prepare",children:Object(v.jsx)(ke,{})}),Object(v.jsx)(x.b,{exact:!0,path:"/meetingroom",children:Object(v.jsx)(Ne,{})}),Object(v.jsx)(x.b,{exact:!0,path:"/wrapup",children:Object(v.jsx)(Te,{})}),Object(v.jsx)(x.b,{path:"*",component:Ee})]}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(x.b,{exact:!0,path:"/",children:Object(v.jsx)(q,{})}),Object(v.jsx)(x.b,{path:"*",children:Object(v.jsx)(x.a,{to:"/"})})]})})]})},Me=n(207),Ue=n.n(Me);n(361);var qe=function(){var e=Object(a.useState)(!1),t=Object(s.a)(e,2),n=t[0],r=t[1],c=Object(i.b)();return Object(a.useEffect)((function(){d.onAuthStateChanged((function(e){console.log("onAuthStateChanged"),c(e?{type:"AUTH_STATE_CHANGED",user:e}:{type:"AUTH_STATE_CHANGED",user:null}),r(!0)}))}),[]),Object(v.jsx)(v.Fragment,{children:n?Object(v.jsx)(v.Fragment,{children:Object(v.jsx)(Re,{})}):Object(v.jsx)("div",{className:"loading",children:Object(v.jsx)(Ue.a,{className:"icon"})})})},Pe=n(149),Fe=n(103),He={page:n(209)};Pe.a.use(Fe.e).init({resources:{ko:He},lng:"ko",fallbackLng:"ko",ns:["page"],interpolation:{escapeValue:!1}});Pe.a,n(362);var Le=n(213),Ve=Object(Le.a)((function(e,t){return void 0===e?{loginedUser:null}:"AUTH_STATE_CHANGED"===t.type?Object(P.a)(Object(P.a)({},e),{},{loginedUser:t.user}):e}),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());o.a.render(Object(v.jsx)(i.a,{store:Ve,children:Object(v.jsx)(qe,{})}),document.getElementById("root"))}},[[363,1,2]]]);
//# sourceMappingURL=main.4d662916.chunk.js.map