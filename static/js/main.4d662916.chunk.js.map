{"version":3,"sources":["fbase.js","components/Header.js","components/AuthForm.js","routes/Auth.js","components/RoomInfo.js","routes/Lobby.js","components/volumemeter/audioworklet/useVolume.js","components/volumemeter/volumemeter/index.js","components/volumemeter/audioworklet/index.js","components/volumemeter/index.js","components/MediaInfo.js","routes/CreateRoom.js","components/MeetingRoomVideo.js","components/MessageInfo.js","components/MeetingRoomMessage.js","routes/MeetingRoom.js","routes/Prepare.js","routes/Wrapup.js","routes/NotFound.js","components/Router.js","components/App.js","i18n/locales/ko/index.js","i18n/index.js","store.js","index.js"],"names":["authService","initializeApp","apiKey","process","authDomain","projectId","storageBucket","messagingSenderId","appId","getAuth","dbService","getFirestore","Header","t","useTranslation","history","useHistory","loginedUser","useSelector","store","useState","anchorEl","setAnchorEl","open","Boolean","handleClick","event","currentTarget","handleClose","className","Container","maxWidth","onClick","push","Menu","id","onClose","MenuListProps","MenuItem","signOut","photoURL","displayName","src","undefined","AuthForm","createMode","setCreateMode","error","setError","validationSchema","yup","email","required","password","min","formik","useFormik","initialValues","onSubmit","values","onEmailSubmit","a","createUserWithEmailAndPassword","signInWithEmailAndPassword","message","Box","component","noValidate","autoComplete","handleSubmit","TextField","name","type","label","variant","value","onChange","handleChange","touched","errors","helperText","Button","prev","Auth","onAnonymousClick","signInAnonymously","onSocialClick","provider","GoogleAuthProvider","FacebookAuthProvider","console","log","signInWithPopup","startIcon","style","fill","RoomInfo","roomObj","isOwner","deleteMyRoom","deleteDoc","doc","Card","sessionInfo","entranceRoom","window","sessionStorage","setItem","JSON","stringify","CardContent","DateTime","fromMillis","createdAt","toFormat","creatorNickName","creatorPhotoUrl","IconButton","stopPropagation","confirm","Lobby","rooms","setRooms","useEffect","getRooms","q","query","collection","orderBy","unsubscribe","onSnapshot","snapshot","roomArr","docs","map","data","onAuthStateChanged","user","Grid","container","spacing","justifyContent","alignItems","item","xs","sm","md","lg","filter","room","creatorId","uid","useVolume","stream","React","volume","setVolume","ref","useRef","onmessage","useCallback","current","audioContext","Math","round","disconnectAudioContext","node","disconnect","errMsg","source","connectAudioContext","mediaStream","AudioContext","audioWorklet","addModule","createMediaStreamSource","AudioWorkletNode","port","connect","destination","VolumeMeter","max","dividerList","useMemo","list","width","i","left","transform","ceil","defaultProps","memo","p","n","AudioWorkletNodeVolumeMeter","MediaInfo","onCameraChange","videoPreview","cameras","setCameras","selectCamera","setSelectCamera","setStream","getMedia","cleanup","getTracks","forEach","track","stop","deviceId","initialConstrains","audio","video","facingMode","cameraConstrains","exact","navigator","mediaDevices","getUserMedia","myStream","srcObject","getCameras","enumerateDevices","devices","videoCameras","device","kind","cameraArr","videoCamera","text","tracks","getSettings","length","handleCameraChange","target","autoPlay","playsInline","FormControl","InputLabel","Select","labelId","CreateRoom","setDeviceId","roomname","nickname","onCreateRoomSubmit","newRoom","now","toMillis","addDoc","docRef","nickName","MeetingRoomVideo","isMuted","setIsMuted","muted","MessageInfo","messageObj","roomId","deleteMessage","MeetingRoomMessage","userId","userNickName","userPhotoUrl","messages","setMessages","messagesList","onMessageSubmit","getMessages","messageArr","scrollTop","scrollHeight","newMessage","handleReset","slice","reverse","autoFocus","fullWidth","placeholder","InputProps","endAdornment","color","useScroll","scrollY","setScrollY","listener","pageYOffset","addEventListener","removeEventListener","MeetingRoom","localStream","newSocket","pcs","parse","getItem","setSocket","users","setUsers","isMessagesSmallMode","setIsMessagesSmallMode","videoWrapper","computeMessagesMode","initWebRTC","cleanupSocket","cleanupStream","handleSocket","socketIOClient","on","emit","allUsers","len","createPeerConnection","pc","createOffer","offerToReceiveAudio","offerToReceiveVideo","then","sdp","setLocalDescription","RTCSessionDescription","offerSendID","offerSendNickName","offerReceiveID","catch","setRemoteDescription","createAnswer","answerSendID","answerReceiveID","candidateSendID","addIceCandidate","RTCIceCandidate","candidate","close","oldUsers","socketID","RTCPeerConnection","iceServers","urls","onicecandidate","e","candidateReceiveID","oniceconnectionstatechange","ontrack","streams","addTrack","getVideoCountPerRow","grid","Array","from","children","baseOffset","offsetTop","breakIndex","findIndex","index","getAudioTracks","enabled","Prepare","setRoomId","setRoom","onEntranceRoomSubmit","getRoom","getDoc","docSnap","exists","Number","Wrapup","startTime","setStartTime","durationTime","setDurationTime","roomName","setRoomName","diff","replace","messagesQuery","getDocs","messageSnapshot","time","isAnonymous","filename","NotFound","FragmentSupportingSwitch","flattenedChildren","flatten","createElement","apply","Switch","concat","Children","child","isValidElement","Fragment","props","AppRouter","basename","path","to","App","init","setInit","dispatch","useDispatch","page","i18n","use","initReactI18next","resources","ko","lng","fallbackLng","ns","interpolation","escapeValue","createStore","state","action","__REDUX_DEVTOOLS_EXTENSION__","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.4d662916.chunk.js","sourcesContent":["import { initializeApp } from \"firebase/app\";\r\nimport { getAuth } from \"firebase/auth\";\r\nimport { getFirestore } from \"firebase/firestore\";\r\n\r\nconst firebaseConfig = {\r\n  apiKey: process.env.REACT_APP_API_KEY,\r\n  authDomain: process.env.REACT_APP_AUTH_DOMAIN,\r\n  projectId: process.env.REACT_APP_PROJECTID,\r\n  storageBucket: process.env.REACT_APP_STORAGE_BUCKET,\r\n  messagingSenderId: process.env.REACT_APP_MESSAGIN_ID,\r\n  appId: process.env.REACT_APP_APP_ID,\r\n};\r\n\r\nconst app = initializeApp(firebaseConfig);\r\nexport const authService = getAuth();\r\nexport const dbService = getFirestore();\r\n","import { Container, Menu, MenuItem } from \"@mui/material\";\r\nimport React, { useState } from \"react\";\r\nimport { authService } from \"fbase\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useSelector } from \"react-redux\";\r\nimport AccountCircleIcon from \"@mui/icons-material/AccountCircle\";\r\nimport { useHistory } from \"react-router\";\r\nimport \"./Header.scss\";\r\n\r\nconst Header = () => {\r\n  const { t } = useTranslation([\"page\"]);\r\n  const history = useHistory();\r\n  const loginedUser = useSelector((store) => store.loginedUser);\r\n\r\n  const [anchorEl, setAnchorEl] = useState(null);\r\n  const open = Boolean(anchorEl);\r\n\r\n  const handleClick = (event) => {\r\n    setAnchorEl(event.currentTarget);\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setAnchorEl(null);\r\n  };\r\n\r\n  const onLogOutClick = () => {\r\n    handleClose();\r\n    authService.signOut();\r\n  };\r\n\r\n  const onGotoHomeClick = () => {\r\n    history.push(\"/\");\r\n  };\r\n\r\n  return (\r\n    <header className=\"header\">\r\n      <Container maxWidth=\"lg\">\r\n        <div className=\"header-container\">\r\n          <span className=\"logo\" onClick={onGotoHomeClick}>\r\n            Meeting Note\r\n          </span>\r\n          <Menu\r\n            id=\"basic-menu\"\r\n            anchorEl={anchorEl}\r\n            open={open}\r\n            onClose={handleClose}\r\n            MenuListProps={{\r\n              \"aria-labelledby\": \"basic-button\",\r\n            }}\r\n          >\r\n            <MenuItem onClick={onLogOutClick}>\r\n              {t(\"page:common:logout\")}\r\n            </MenuItem>\r\n          </Menu>\r\n\r\n          {loginedUser ? (\r\n            <>\r\n              {loginedUser.photoURL ? (\r\n                <div className=\"user-info\">\r\n                  <span>{loginedUser.displayName}</span>\r\n                  <img\r\n                    src={loginedUser.photoURL}\r\n                    aria-controls=\"basic-menu\"\r\n                    aria-haspopup=\"true\"\r\n                    aria-expanded={open ? \"true\" : undefined}\r\n                    onClick={handleClick}\r\n                  />\r\n                </div>\r\n              ) : (\r\n                <AccountCircleIcon\r\n                  className=\"anony\"\r\n                  aria-controls=\"basic-menu\"\r\n                  aria-haspopup=\"true\"\r\n                  aria-expanded={open ? \"true\" : undefined}\r\n                  onClick={handleClick}\r\n                />\r\n              )}\r\n            </>\r\n          ) : (\r\n            <></>\r\n          )}\r\n        </div>\r\n      </Container>\r\n    </header>\r\n  );\r\n};\r\n\r\nexport default Header;\r\n","import React, { useState } from \"react\";\r\nimport {\r\n  createUserWithEmailAndPassword,\r\n  signInWithEmailAndPassword,\r\n} from \"firebase/auth\";\r\nimport { authService } from \"fbase\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport Box from \"@mui/material/Box\";\r\nimport TextField from \"@mui/material/TextField\";\r\nimport { Button } from \"@mui/material\";\r\nimport { useFormik } from \"formik\";\r\nimport * as yup from \"yup\";\r\nimport \"./AuthForm.scss\";\r\n\r\nconst AuthForm = () => {\r\n  const { t } = useTranslation([\"page\"]);\r\n  const [createMode, setCreateMode] = useState(false);\r\n  const [error, setError] = useState(\"\");\r\n\r\n  const validationSchema = yup.object({\r\n    email: yup\r\n      .string(t(\"page:auth_form:validation:enter_email\"))\r\n      .email(t(\"page:auth_form:validation:valid_email\"))\r\n      .required(t(\"page:auth_form:validation:require_email\")),\r\n    password: yup\r\n      .string(t(\"page:auth_form:validation:enter_password\"))\r\n      .min(6, t(\"page:auth_form:validation:valid_password\"))\r\n      .required(t(\"page:auth_form:validation:require_password\")),\r\n  });\r\n\r\n  const formik = useFormik({\r\n    initialValues: {\r\n      email: \"\",\r\n      password: \"\",\r\n    },\r\n    validationSchema: validationSchema,\r\n    onSubmit: (values) => {\r\n      onEmailSubmit(values.email, values.password);\r\n    },\r\n  });\r\n\r\n  const onEmailSubmit = async (email, password) => {\r\n    let data;\r\n    try {\r\n      if (createMode) {\r\n        data = await createUserWithEmailAndPassword(\r\n          authService,\r\n          email,\r\n          password\r\n        );\r\n      } else {\r\n        data = await signInWithEmailAndPassword(authService, email, password);\r\n      }\r\n    } catch (error) {\r\n      setError(error.message);\r\n    }\r\n  };\r\n\r\n  const toggleCreateMode = () => setCreateMode((prev) => !prev);\r\n\r\n  return (\r\n    <>\r\n      <Box\r\n        className=\"login-box\"\r\n        component=\"form\"\r\n        noValidate\r\n        autoComplete=\"off\"\r\n        onSubmit={formik.handleSubmit}\r\n      >\r\n        <TextField\r\n          name=\"email\"\r\n          type=\"email\"\r\n          label={t(\"page:auth_form:label_email\")}\r\n          variant=\"standard\"\r\n          required\r\n          value={formik.values.email}\r\n          onChange={formik.handleChange}\r\n          error={formik.touched.email && Boolean(formik.errors.email)}\r\n          helperText={formik.touched.email && formik.errors.email}\r\n        />\r\n        <br />\r\n        <TextField\r\n          name=\"password\"\r\n          type=\"password\"\r\n          label={t(\"page:auth_form:label_password\")}\r\n          variant=\"standard\"\r\n          required\r\n          value={formik.values.password}\r\n          onChange={formik.handleChange}\r\n          error={formik.touched.password && Boolean(formik.errors.password)}\r\n          helperText={formik.touched.password && formik.errors.password}\r\n        />\r\n        <br />\r\n        <Button type=\"submit\" variant=\"contained\">\r\n          {createMode\r\n            ? t(\"page:auth_form:sign_up\")\r\n            : t(\"page:auth_form:sign_in\")}\r\n        </Button>\r\n      </Box>\r\n      <Button className=\"toggle-mode\" onClick={toggleCreateMode}>\r\n        {createMode ? t(\"page:auth_form:sign_in\") : t(\"page:auth_form:sign_up\")}\r\n      </Button>\r\n      <div className=\"error\">{error}</div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default AuthForm;\r\n","import React, { useState } from \"react\";\r\nimport {\r\n  signInWithPopup,\r\n  GoogleAuthProvider,\r\n  FacebookAuthProvider,\r\n  signInAnonymously,\r\n} from \"firebase/auth\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { authService } from \"../fbase\";\r\nimport AuthForm from \"components/AuthForm\";\r\nimport { Button, Container } from \"@mui/material\";\r\nimport AccountCircleIcon from \"@mui/icons-material/AccountCircle\";\r\nimport GoogleIcon from \"@mui/icons-material/Google\";\r\nimport FacebookIcon from \"@mui/icons-material/Facebook\";\r\nimport \"./Auth.scss\";\r\n\r\nconst Auth = () => {\r\n  const { t } = useTranslation([\"page\"]);\r\n  const [error, setError] = useState(\"\");\r\n\r\n  const onAnonymousClick = async (event) => {\r\n    try {\r\n      await signInAnonymously(authService);\r\n    } catch (error) {\r\n      setError(error.message);\r\n    }\r\n  };\r\n\r\n  const onSocialClick = async (event, type) => {\r\n    let provider;\r\n    if (type === \"google\") {\r\n      provider = new GoogleAuthProvider();\r\n    } else if (type === \"facebook\") {\r\n      provider = new FacebookAuthProvider();\r\n    } else {\r\n      console.log(\"check social login type\");\r\n    }\r\n\r\n    try {\r\n      await signInWithPopup(authService, provider);\r\n    } catch (error) {\r\n      setError(error.message);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Container className=\"container login-container\" maxWidth=\"xs\">\r\n      <AuthForm></AuthForm>\r\n      <div className=\"social-container\">\r\n        <Button\r\n          className=\"btn-anony\"\r\n          variant=\"contained\"\r\n          onClick={onAnonymousClick}\r\n          startIcon={<AccountCircleIcon />}\r\n        >\r\n          {t(\"page:auth:login_with_anony\")}\r\n        </Button>\r\n        <br />\r\n        <Button\r\n          className=\"btn-google\"\r\n          variant=\"contained\"\r\n          onClick={(event) => onSocialClick(event, \"google\")}\r\n          startIcon={<GoogleIcon style={{ fill: \"#d50f25\" }} />}\r\n        >\r\n          {t(\"page:auth:login_with_google\")}\r\n        </Button>\r\n        <br />\r\n        <Button\r\n          className=\"btn-facebook\"\r\n          variant=\"contained\"\r\n          onClick={(event) => onSocialClick(event, \"facebook\")}\r\n          startIcon={<FacebookIcon />}\r\n        >\r\n          {t(\"page:auth:login_with_facebook\")}\r\n        </Button>\r\n        <div className=\"error\">{error}</div>\r\n      </div>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default Auth;\r\n","import React, { useState } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useHistory } from \"react-router\";\r\nimport { Card, CardContent, IconButton } from \"@mui/material\";\r\nimport AccountCircleIcon from \"@mui/icons-material/AccountCircle\";\r\nimport { DateTime } from \"luxon\";\r\nimport { deleteDoc, doc } from \"@firebase/firestore\";\r\nimport { dbService } from \"fbase\";\r\nimport DeleteForeverIcon from \"@mui/icons-material/DeleteForever\";\r\nimport \"./RoomInfo.scss\";\r\n\r\nconst RoomInfo = ({ roomObj, isOwner }) => {\r\n  const { t } = useTranslation([\"page\"]);\r\n  const history = useHistory();\r\n\r\n  const onEntranceClick = () => {\r\n    const sessionInfo = {\r\n      entranceRoom: { id: roomObj.id },\r\n    };\r\n    window.sessionStorage.setItem(\"sessionInfo\", JSON.stringify(sessionInfo));\r\n    history.push(\"/prepare\");\r\n  };\r\n\r\n  const deleteMyRoom = async () => {\r\n    await deleteDoc(doc(dbService, `rooms/${roomObj.id}`));\r\n  };\r\n\r\n  const onDeleteClick = (event) => {\r\n    event.stopPropagation();\r\n    const ok = window.confirm(t(\"page:room_info:delete_confirm\"));\r\n    if (ok) {\r\n      deleteMyRoom();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Card onClick={onEntranceClick}>\r\n      <CardContent>\r\n        <div className=\"room-creator-time\">\r\n          {DateTime.fromMillis(roomObj.createdAt).toFormat(\"MM/dd HH:mm\")}\r\n        </div>\r\n        <div className=\"room-name\">{roomObj.name}</div>\r\n        <div className=\"room-creator-info\">\r\n          <span>{roomObj.creatorNickName}</span>\r\n          {roomObj.creatorPhotoUrl ? (\r\n            <img src={roomObj.creatorPhotoUrl} />\r\n          ) : (\r\n            <AccountCircleIcon className=\"anony\" />\r\n          )}\r\n          {isOwner ? (\r\n            <IconButton\r\n              className=\"btn-room-delete\"\r\n              onClick={onDeleteClick}\r\n              aria-label={t(\"page:room_info:delete\")}\r\n            >\r\n              <DeleteForeverIcon />\r\n            </IconButton>\r\n          ) : (\r\n            \"\"\r\n          )}\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default RoomInfo;\r\n","import {\r\n  collection,\r\n  doc,\r\n  onSnapshot,\r\n  orderBy,\r\n  query,\r\n} from \"@firebase/firestore\";\r\nimport { Container, Grid } from \"@mui/material\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport RoomInfo from \"../components/RoomInfo\";\r\nimport { authService, dbService } from \"../fbase\";\r\nimport { Card, CardContent } from \"@mui/material\";\r\nimport AddIcon from \"@mui/icons-material/Add\";\r\nimport \"./Lobby.scss\";\r\n\r\nconst Lobby = () => {\r\n  const { t } = useTranslation([\"page\"]);\r\n  const history = useHistory();\r\n  const loginedUser = useSelector((store) => store.loginedUser);\r\n\r\n  const [rooms, setRooms] = useState([]);\r\n\r\n  useEffect(() => {\r\n    getRooms();\r\n  }, []);\r\n\r\n  const getRooms = () => {\r\n    const q = query(\r\n      collection(dbService, \"rooms\"),\r\n      orderBy(\"createdAt\", \"desc\")\r\n    );\r\n    const unsubscribe = onSnapshot(q, (snapshot) => {\r\n      const roomArr = snapshot.docs.map((doc) => ({\r\n        id: doc.id,\r\n        ...doc.data(),\r\n      }));\r\n      setRooms(roomArr);\r\n    });\r\n\r\n    authService.onAuthStateChanged((user) => {\r\n      if (user === null) {\r\n        unsubscribe();\r\n      }\r\n    });\r\n  };\r\n\r\n  const onCreateRoomClick = () => {\r\n    history.push(\"/createroom\");\r\n  };\r\n\r\n  return (\r\n    <Container className=\"container lobby-container\" maxWidth=\"lg\">\r\n      <div className=\"room-container-title\">\r\n        <span>{t(\"page:lobby:my_room_title\")}</span>\r\n      </div>\r\n      <Grid\r\n        container\r\n        spacing={3}\r\n        justifyContent=\"flex-start\"\r\n        alignItems=\"stretch\"\r\n      >\r\n        <Grid item xs={12} sm={6} md={4} lg={3}>\r\n          <Card className=\"btn-create-card\" onClick={onCreateRoomClick}>\r\n            <CardContent className=\"btn-create-content\">\r\n              <AddIcon className=\"btn-create-icon\" />\r\n              <div className=\"btn-create-label\">\r\n                {t(\"page:lobby:create_room\")}\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </Grid>\r\n        {rooms\r\n          .filter((room) => room.creatorId === loginedUser.uid)\r\n          .map((room) => (\r\n            <Grid key={room.id} item xs={12} sm={6} md={4} lg={3}>\r\n              <RoomInfo key={room.id} roomObj={room} isOwner={true} />\r\n            </Grid>\r\n          ))}\r\n      </Grid>\r\n      <div className=\"divider\"></div>\r\n      <div className=\"room-container-title\">\r\n        <span>{t(\"page:lobby:other_room_title\")}</span>\r\n      </div>\r\n      <Grid container spacing={3}>\r\n        {rooms\r\n          .filter((room) => room.creatorId !== loginedUser.uid)\r\n          .map((room) => (\r\n            <Grid key={room.id} item xs={12} sm={6} md={4} lg={3}>\r\n              <RoomInfo key={room.id} roomObj={room} isOwner={false} />\r\n            </Grid>\r\n          ))}\r\n      </Grid>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default Lobby;\r\n","import React from \"react\";\n\nfunction useVolume(stream) {\n  const [volume, setVolume] = React.useState(0);\n\n  const ref = React.useRef({});\n\n  const onmessage = React.useCallback((event) => {\n    if (!ref.current.audioContext) {\n      return;\n    }\n    if (event.data.volume) {\n      setVolume(Math.round(event.data.volume * 200));\n    }\n  }, []);\n\n  const disconnectAudioContext = React.useCallback(() => {\n    if (ref.current.node) {\n      try {\n        ref.current.node.disconnect();\n      } catch (errMsg) {}\n    }\n    if (ref.current.source) {\n      try {\n        ref.current.source.disconnect();\n      } catch (errMsg) {}\n    }\n    ref.current.node = null;\n    ref.current.source = null;\n    ref.current.audioContext = null;\n    setVolume(0);\n  }, []);\n\n  const connectAudioContext = React.useCallback(\n    async (mediaStream) => {\n      if (ref.current.audioContext) {\n        disconnectAudioContext();\n      }\n      try {\n        ref.current.audioContext = new AudioContext();\n        await ref.current.audioContext.audioWorklet.addModule(\n          \"./worklet/vumeter.js\"\n        );\n        if (!ref.current.audioContext) {\n          return;\n        }\n        ref.current.source =\n          ref.current.audioContext.createMediaStreamSource(mediaStream);\n        ref.current.node = new AudioWorkletNode(\n          ref.current.audioContext,\n          \"vumeter\"\n        );\n        ref.current.node.port.onmessage = onmessage;\n        ref.current.source\n          .connect(ref.current.node)\n          .connect(ref.current.audioContext.destination);\n      } catch (errMsg) {\n        disconnectAudioContext();\n      }\n    },\n    [disconnectAudioContext, onmessage]\n  );\n\n  React.useEffect(() => {\n    setVolume(0);\n    if (!stream) {\n      return () => {};\n    }\n    connectAudioContext(stream);\n    return () => {\n      disconnectAudioContext(stream);\n    };\n  }, [stream, connectAudioContext, disconnectAudioContext]);\n\n  return volume;\n}\n\nexport default useVolume;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport \"./index.css\";\n\nconst VolumeMeter = ({ volume, max = 10, style = {} }) => {\n  const dividerList = React.useMemo(() => {\n    const list = [];\n    const width = 100 / (max * 2);\n    for (let i = 0; i < max; i += 1) {\n      list.push(\n        <div\n          key={i}\n          className=\"volumeMeterDivider\"\n          style={{ left: `${(2 * i + 1) * width}%`, width: `${width}%` }}\n        />\n      );\n    }\n    return list;\n  }, [max]);\n\n  return (\n    <div className=\"volumeMeter\" style={style}>\n      <div className=\"volumeMeterBg\" />\n      <div\n        className=\"volumeMeterInner\"\n        style={{\n          transform: `scaleX(${Math.ceil((volume * max) / 100) / max})`,\n        }}\n      />\n      {dividerList}\n    </div>\n  );\n};\n\nVolumeMeter.propTypes = {\n  volume: PropTypes.number,\n  max: PropTypes.number,\n  style: PropTypes.object,\n};\n\nVolumeMeter.defaultProps = {\n  volume: null,\n  max: 0,\n  style: null,\n};\n\nexport default React.memo(\n  VolumeMeter,\n  (p, n) => p.volume === n.volume && p.max === n.max && p.style === n.style\n);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport useVolume from \"./useVolume\";\nimport VolumeMeter from \"../volumemeter\";\n\nconst AudioWorkletNodeVolumeMeter = ({ stream, max, style }) => {\n  const volume = useVolume(stream);\n  return <VolumeMeter volume={volume} max={max} style={style} />;\n};\n\nAudioWorkletNodeVolumeMeter.propTypes = {\n  stream: PropTypes.object,\n  max: PropTypes.number,\n  style: PropTypes.object,\n};\n\nAudioWorkletNodeVolumeMeter.defaultProps = {\n  stream: null,\n  max: 0,\n  style: null,\n};\n\nexport default React.memo(\n  AudioWorkletNodeVolumeMeter,\n  (p, n) => p.stream === n.stream && p.max === n.max && p.style === n.style\n);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport AudioWorkletNodeVolumeMeter from \"./audioworklet\";\nimport \"./index.css\";\n\nconst VolumeMeter = ({ stream, max = 20, style = {} }) => {\n  return (\n    <AudioWorkletNodeVolumeMeter stream={stream} max={max} style={style} />\n  );\n};\n\nVolumeMeter.propTypes = {\n  type: PropTypes.oneOf([\"AudioWorkletNode\"]),\n  stream: PropTypes.object,\n  max: PropTypes.number,\n  style: PropTypes.object,\n};\n\nVolumeMeter.defaultProps = {\n  type: \"AudioWorkletNode\",\n  stream: null,\n  max: 0,\n  style: null,\n};\n\nexport default React.memo(\n  VolumeMeter,\n  (p, n) =>\n    p.type === n.type &&\n    p.stream === n.stream &&\n    p.max === n.max &&\n    p.style === n.style\n);\n","import React, { useEffect, useRef, useState } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { InputLabel, MenuItem, Select } from \"@mui/material\";\r\nimport FormControl from \"@mui/material/FormControl\";\r\nimport VolumeMeter from \"components/volumemeter\";\r\nimport MicIcon from \"@mui/icons-material/Mic\";\r\nimport \"./MediaInfo.scss\";\r\n\r\nconst MediaInfo = ({ onCameraChange }) => {\r\n  const { t } = useTranslation([\"page\"]);\r\n\r\n  const videoPreview = useRef();\r\n\r\n  const [error, setError] = useState(\"\");\r\n  const [cameras, setCameras] = useState([]);\r\n  const [selectCamera, setSelectCamera] = useState(\"\");\r\n  const [stream, setStream] = useState(null);\r\n\r\n  useEffect(() => {\r\n    getMedia();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      cleanup();\r\n    };\r\n  }, [stream]);\r\n\r\n  const cleanup = () => {\r\n    if (stream) {\r\n      stream.getTracks().forEach((track) => {\r\n        track.stop();\r\n      });\r\n    }\r\n  };\r\n\r\n  const getMedia = async (deviceId) => {\r\n    const initialConstrains = {\r\n      audio: true,\r\n      video: { facingMode: \"user\" },\r\n    };\r\n    const cameraConstrains = {\r\n      audio: true,\r\n      video: { deviceId: { exact: deviceId } },\r\n    };\r\n\r\n    try {\r\n      let myStream = await navigator.mediaDevices.getUserMedia(\r\n        deviceId ? cameraConstrains : initialConstrains\r\n      );\r\n      videoPreview.current.srcObject = myStream;\r\n      setStream(myStream);\r\n\r\n      if (!deviceId) {\r\n        await getCameras(myStream);\r\n      }\r\n    } catch (error) {\r\n      setError(error.message);\r\n    }\r\n  };\r\n\r\n  const getCameras = async (myStream) => {\r\n    try {\r\n      const devices = await navigator.mediaDevices.enumerateDevices();\r\n      const videoCameras = devices.filter(\r\n        (device) => device.kind === \"videoinput\"\r\n      );\r\n      const cameraArr = videoCameras.map((videoCamera) => ({\r\n        value: videoCamera.deviceId,\r\n        text: videoCamera.label,\r\n      }));\r\n      setCameras(cameraArr);\r\n\r\n      let tracks = myStream.getTracks();\r\n      for (let i = 0; i < tracks.length; i++) {\r\n        let deviceId = tracks[i].getSettings().deviceId;\r\n        videoCameras.forEach((videoCamera) => {\r\n          if (deviceId === videoCamera.deviceId) {\r\n            setSelectCamera(deviceId);\r\n            onCameraChange(deviceId);\r\n          }\r\n        });\r\n      }\r\n    } catch (error) {\r\n      setError(error.message);\r\n    }\r\n  };\r\n\r\n  const handleCameraChange = async (event) => {\r\n    setSelectCamera(event.target.value);\r\n    onCameraChange(event.target.value);\r\n    await getMedia(event.target.value);\r\n  };\r\n\r\n  return (\r\n    <div className=\"media-box\">\r\n      <video\r\n        className=\"video-preview\"\r\n        ref={videoPreview}\r\n        autoPlay\r\n        playsInline\r\n      />\r\n      <div className=\"mic-wrapper\">\r\n        <MicIcon />\r\n        <VolumeMeter className=\"volume-meter\" stream={stream} max={40} />\r\n      </div>\r\n      <FormControl className=\"select-camera\" variant=\"standard\">\r\n        <InputLabel id=\"select-camera-label\">\r\n          {t(\"page:media_info:select_camera_label\")}\r\n        </InputLabel>\r\n        <Select\r\n          labelId=\"select-camera-label\"\r\n          value={selectCamera}\r\n          onChange={handleCameraChange}\r\n          label=\"Camera\"\r\n        >\r\n          {cameras.map((item) => {\r\n            return (\r\n              <MenuItem key={item.value} value={item.value}>\r\n                {item.text}\r\n              </MenuItem>\r\n            );\r\n          })}\r\n        </Select>\r\n      </FormControl>\r\n      <div className=\"error\">{error}</div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MediaInfo;\r\n","import React, { useState } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { addDoc, collection } from \"@firebase/firestore\";\r\nimport { dbService } from \"../fbase\";\r\nimport { useHistory } from \"react-router\";\r\nimport Box from \"@mui/material/Box\";\r\nimport TextField from \"@mui/material/TextField\";\r\nimport { Button, Container } from \"@mui/material\";\r\nimport { useFormik } from \"formik\";\r\nimport * as yup from \"yup\";\r\nimport MediaInfo from \"components/MediaInfo\";\r\nimport { DateTime } from \"luxon\";\r\nimport \"./CreateRoom.scss\";\r\n\r\nconst CreateRoom = () => {\r\n  const { t } = useTranslation([\"page\"]);\r\n  const history = useHistory();\r\n  const { uid, displayName, photoURL } = useSelector(\r\n    (store) => store.loginedUser\r\n  );\r\n\r\n  const [error, setError] = useState(\"\");\r\n  const [deviceId, setDeviceId] = useState(\"\");\r\n\r\n  const validationSchema = yup.object({\r\n    roomname: yup\r\n      .string(t(\"page:room_submit:validation:enter_roomname\"))\r\n      .max(20, t(\"page:room_submit:validation:valid_roomname\"))\r\n      .required(t(\"page:room_submit:validation:require_roomname\")),\r\n    nickname: yup\r\n      .string(t(\"page:room_submit:validation:enter_nickname\"))\r\n      .max(20, t(\"page:room_submit:validation:valid_nickname\"))\r\n      .required(t(\"page:room_submit:validation:require_nickname\")),\r\n  });\r\n\r\n  const formik = useFormik({\r\n    initialValues: {\r\n      roomname: \"\",\r\n      nickname: displayName,\r\n    },\r\n    validationSchema: validationSchema,\r\n    onSubmit: (values) => {\r\n      onCreateRoomSubmit(values.roomname, values.nickname);\r\n    },\r\n  });\r\n\r\n  const onCreateRoomSubmit = async (roomname, nickname) => {\r\n    const newRoom = {\r\n      name: roomname,\r\n      creatorId: uid,\r\n      creatorNickName: nickname,\r\n      creatorPhotoUrl: photoURL,\r\n      createdAt: DateTime.now().toMillis(),\r\n    };\r\n\r\n    try {\r\n      const docRef = await addDoc(collection(dbService, \"rooms\"), newRoom);\r\n      const sessionInfo = {\r\n        deviceId: deviceId,\r\n        nickName: nickname,\r\n        entranceRoom: { id: docRef.id, ...newRoom },\r\n      };\r\n      window.sessionStorage.setItem(\"sessionInfo\", JSON.stringify(sessionInfo));\r\n      history.push(\"/meetingroom\");\r\n    } catch (error) {\r\n      setError(error);\r\n    }\r\n  };\r\n\r\n  const onCameraChange = (deviceId) => {\r\n    setDeviceId(deviceId);\r\n  };\r\n\r\n  return (\r\n    <Container className=\"container create-room-container\" maxWidth=\"xs\">\r\n      <MediaInfo onCameraChange={onCameraChange}></MediaInfo>\r\n      <Box\r\n        className=\"create-room-box\"\r\n        component=\"form\"\r\n        noValidate\r\n        autoComplete=\"off\"\r\n        onSubmit={formik.handleSubmit}\r\n      >\r\n        <TextField\r\n          name=\"roomname\"\r\n          label={t(\"page:create_room:roomname_label\")}\r\n          variant=\"standard\"\r\n          required\r\n          value={formik.values.roomname}\r\n          onChange={formik.handleChange}\r\n          error={formik.touched.roomname && Boolean(formik.errors.roomname)}\r\n          helperText={formik.touched.roomname && formik.errors.roomname}\r\n        />\r\n        <br />\r\n        <TextField\r\n          name=\"nickname\"\r\n          label={t(\"page:create_room:nickname_label\")}\r\n          variant=\"standard\"\r\n          required\r\n          value={formik.values.nickname}\r\n          onChange={formik.handleChange}\r\n          error={formik.touched.nickname && Boolean(formik.errors.nickname)}\r\n          helperText={formik.touched.nickname && formik.errors.nickname}\r\n        />\r\n        <br />\r\n        <Button type=\"submit\" variant=\"contained\">\r\n          {t(\"page:create_room:create_room_label\")}\r\n        </Button>\r\n      </Box>\r\n      <div className=\"error\">{error}</div>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default CreateRoom;\r\n","import React, { useEffect, useRef, useState } from \"react\";\r\nimport MicIcon from \"@mui/icons-material/Mic\";\r\nimport MicOffIcon from \"@mui/icons-material/MicOff\";\r\nimport \"./MeetingRoomVideo.scss\";\r\n\r\nconst MeetingRoomVideo = ({ nickName, stream, isOwner }) => {\r\n  const ref = useRef(null);\r\n  const [isMuted, setIsMuted] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (ref.current) {\r\n      ref.current.srcObject = stream;\r\n    }\r\n  }, [stream]);\r\n\r\n  const toggleMuteMode = () => setIsMuted((prev) => !prev);\r\n\r\n  return (\r\n    <div className=\"meeting-room-video\">\r\n      <video ref={ref} muted={isMuted} autoPlay playsInline />\r\n      <span className=\"meeting-room-nickname\">\r\n        {nickName ? nickName : \"익명사용자\"}\r\n      </span>\r\n      {isOwner ? (\r\n        \"\"\r\n      ) : (\r\n        <div className=\"mic-icon-wrapper\" onClick={toggleMuteMode}>\r\n          {isMuted ? (\r\n            <MicOffIcon className=\"mic-iocn\" />\r\n          ) : (\r\n            <MicIcon className=\"mic-iocn\" />\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MeetingRoomVideo;\r\n","import React from \"react\";\r\nimport { deleteDoc, doc } from \"@firebase/firestore\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { dbService } from \"fbase\";\r\nimport { DateTime } from \"luxon\";\r\nimport { IconButton } from \"@mui/material\";\r\nimport AccountCircleIcon from \"@mui/icons-material/AccountCircle\";\r\nimport DeleteForeverIcon from \"@mui/icons-material/DeleteForever\";\r\nimport \"./MessageInfo.scss\";\r\n\r\nconst MessageInfo = ({ messageObj, isOwner, roomId }) => {\r\n  const { t } = useTranslation([\"page\"]);\r\n\r\n  const onDeleteClick = () => {\r\n    const ok = window.confirm(\r\n      t(\"page:meetingroom_message:message_delete_confirm\")\r\n    );\r\n    if (ok) {\r\n      deleteMessage();\r\n    }\r\n  };\r\n\r\n  const deleteMessage = async () => {\r\n    await deleteDoc(\r\n      doc(dbService, `rooms/${roomId}/messages/${messageObj.id}`)\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"message-info-box\">\r\n      {messageObj.creatorPhotoUrl ? (\r\n        <img src={messageObj.creatorPhotoUrl} />\r\n      ) : (\r\n        <AccountCircleIcon className=\"anony\" />\r\n      )}\r\n      <span className=\"nickname\">{messageObj.creatorNickName}</span>\r\n      <span className=\"message\">{messageObj.message}</span>\r\n      {/* \r\n      <span className=\"message-time\">\r\n        {DateTime.fromMillis(messageObj.createdAt).toFormat(\"MM/dd HH:mm\")}\r\n      </span>*/}\r\n      {isOwner ? (\r\n        <IconButton\r\n          onClick={onDeleteClick}\r\n          aria-label={t(\"page:meetingroom_message:message_delete\")}\r\n        >\r\n          <DeleteForeverIcon />\r\n        </IconButton>\r\n      ) : (\r\n        \"\"\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MessageInfo;\r\n","import React, { useEffect, useRef, useState } from \"react\";\r\nimport {\r\n  addDoc,\r\n  collection,\r\n  onSnapshot,\r\n  orderBy,\r\n  query,\r\n} from \"@firebase/firestore\";\r\nimport { authService, dbService } from \"../fbase\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { DateTime } from \"luxon\";\r\nimport { useFormik } from \"formik\";\r\nimport * as yup from \"yup\";\r\nimport { Box, IconButton, TextField } from \"@mui/material\";\r\nimport SendIcon from \"@mui/icons-material/Send\";\r\nimport MessageInfo from \"./MessageInfo\";\r\nimport \"./MeetingRoomMessage.scss\";\r\n\r\nconst MeetingRoomMessage = ({ roomId, userId, userNickName, userPhotoUrl }) => {\r\n  const { t } = useTranslation([\"page\"]);\r\n\r\n  const [messages, setMessages] = useState([]);\r\n  const [error, setError] = useState(\"\");\r\n\r\n  const messagesList = useRef();\r\n\r\n  const validationSchema = yup.object({\r\n    message: yup\r\n      .string(t(\"page:meetingroom_message:validation:enter_message\"))\r\n      .max(100, t(\"page:meetingroom_message:validation:valid_message\"))\r\n      .required(t(\"page:meetingroom_message:validation:require_message\")),\r\n  });\r\n\r\n  const formik = useFormik({\r\n    initialValues: {\r\n      message: \"\",\r\n    },\r\n    validationSchema: validationSchema,\r\n    onSubmit: (values) => {\r\n      onMessageSubmit(values.message);\r\n    },\r\n  });\r\n\r\n  useEffect(() => {\r\n    getMessages();\r\n  }, []);\r\n\r\n  const getMessages = () => {\r\n    const q = query(\r\n      collection(dbService, \"rooms\", roomId, \"messages\"),\r\n      orderBy(\"createdAt\", \"desc\")\r\n      //limit(7)\r\n    );\r\n    const unsubscribe = onSnapshot(q, (snapshot) => {\r\n      const messageArr = snapshot.docs.map((doc) => ({\r\n        id: doc.id,\r\n        ...doc.data(),\r\n      }));\r\n      setMessages(messageArr);\r\n      if (messagesList.current) {\r\n        messagesList.current.scrollTop = messagesList.current.scrollHeight;\r\n      }\r\n    });\r\n\r\n    authService.onAuthStateChanged((user) => {\r\n      if (user === null) {\r\n        unsubscribe();\r\n      }\r\n    });\r\n  };\r\n\r\n  const onMessageSubmit = async (message) => {\r\n    try {\r\n      const newMessage = {\r\n        message: message,\r\n        createdAt: DateTime.now().toMillis(),\r\n        creatorId: userId,\r\n        creatorNickName: userNickName,\r\n        creatorPhotoUrl: userPhotoUrl,\r\n      };\r\n      const docRef = await addDoc(\r\n        collection(dbService, \"rooms\", roomId, \"messages\"),\r\n        newMessage\r\n      );\r\n      formik.handleReset();\r\n    } catch (error) {\r\n      setError(error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div ref={messagesList} className=\"messages-list\">\r\n        {messages\r\n          .slice(0)\r\n          .reverse()\r\n          .map((messageObj) => (\r\n            <MessageInfo\r\n              key={messageObj.id}\r\n              messageObj={messageObj}\r\n              isOwner={messageObj.creatorId === userId}\r\n              roomId={roomId}\r\n            />\r\n          ))}\r\n      </div>\r\n      <Box\r\n        className=\"message-box\"\r\n        component=\"form\"\r\n        noValidate\r\n        autoComplete=\"off\"\r\n        onSubmit={formik.handleSubmit}\r\n      >\r\n        <TextField\r\n          autoFocus\r\n          fullWidth\r\n          name=\"message\"\r\n          variant=\"standard\"\r\n          placeholder={t(\"page:meetingroom_message:message_placeholder\")}\r\n          required\r\n          value={formik.values.message}\r\n          onChange={formik.handleChange}\r\n          error={formik.touched.message && Boolean(formik.errors.message)}\r\n          helperText={formik.touched.message && formik.errors.message}\r\n          InputProps={{\r\n            endAdornment: (\r\n              <IconButton\r\n                type=\"submit\"\r\n                color=\"primary\"\r\n                aria-label={t(\"page:meetingroom_message:message_button\")}\r\n              >\r\n                <SendIcon />\r\n              </IconButton>\r\n            ),\r\n          }}\r\n        />\r\n      </Box>\r\n      <div className=\"error\">{error}</div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default MeetingRoomMessage;\r\n","import React, { useEffect, useRef, useState } from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { useHistory } from \"react-router\";\r\nimport socketIOClient from \"socket.io-client\";\r\nimport { Container } from \"@mui/material\";\r\nimport MeetingRoomVideo from \"components/MeetingRoomVideo\";\r\nimport MeetingRoomMessage from \"components/MeetingRoomMessage\";\r\nimport MicIcon from \"@mui/icons-material/Mic\";\r\nimport MicOffIcon from \"@mui/icons-material/MicOff\";\r\nimport NoMeetingRoomIcon from \"@mui/icons-material/NoMeetingRoom\";\r\nimport \"./MeetingRoom.scss\";\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\n//const ENDPOINT = \"http://localhost:4000\";\r\n//const ENDPOINT = \"http://192.168.0.2:4000\";\r\nconst ENDPOINT = \"https://node.zzingobomi.synology.me\";\r\n\r\nconst MeetingRoom = () => {\r\n  const { t } = useTranslation([\"page\"]);\r\n  const loginedUser = useSelector((store) => store.loginedUser);\r\n  const sessionInfo = JSON.parse(window.sessionStorage.getItem(\"sessionInfo\"));\r\n\r\n  const history = useHistory();\r\n\r\n  const [error, setError] = useState(\"\");\r\n  const [deviceId, setDeviceId] = useState(sessionInfo.deviceId);\r\n  const [nickName, setNickName] = useState(sessionInfo.nickName);\r\n  const [entranceRoom, setEntranceRoom] = useState(sessionInfo.entranceRoom);\r\n\r\n  const [stream, setStream] = useState(null);\r\n  const [socket, setSocket] = useState();\r\n  const [users, setUsers] = useState([]);\r\n\r\n  const [isMuted, setIsMuted] = useState(false);\r\n  const [isMessagesSmallMode, setIsMessagesSmallMode] = useState(true);\r\n  const videoWrapper = useRef();\r\n\r\n  const { scrollY } = useScroll();\r\n\r\n  let localStream;\r\n  let newSocket;\r\n  let pcs;\r\n\r\n  useEffect(() => {\r\n    window.addEventListener(\"resize\", computeMessagesMode);\r\n    computeMessagesMode();\r\n    initWebRTC();\r\n    return () => {\r\n      window.removeEventListener(\"resize\", computeMessagesMode);\r\n      cleanupSocket();\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      cleanupStream();\r\n    };\r\n  }, [stream]);\r\n\r\n  useEffect(() => {\r\n    computeMessagesMode();\r\n  }, [users]);\r\n\r\n  const initWebRTC = async () => {\r\n    await getMedia(deviceId);\r\n    handleSocket();\r\n  };\r\n\r\n  const cleanupSocket = () => {\r\n    if (newSocket) {\r\n      newSocket.disconnect();\r\n    }\r\n  };\r\n\r\n  const cleanupStream = () => {\r\n    if (stream) {\r\n      stream.getTracks().forEach((track) => {\r\n        track.stop();\r\n      });\r\n    }\r\n  };\r\n\r\n  const getMedia = async (deviceId) => {\r\n    const initialConstrains = {\r\n      audio: true,\r\n      video: { facingMode: \"user\" },\r\n    };\r\n    const cameraConstrains = {\r\n      audio: true,\r\n      video: { deviceId: { exact: deviceId } },\r\n    };\r\n\r\n    try {\r\n      localStream = await navigator.mediaDevices.getUserMedia(\r\n        deviceId ? cameraConstrains : initialConstrains\r\n      );\r\n      setStream(localStream);\r\n    } catch (error) {\r\n      setError(error.message);\r\n    }\r\n  };\r\n\r\n  const handleSocket = () => {\r\n    console.log(\"handleSocket\");\r\n    newSocket = socketIOClient(ENDPOINT);\r\n    newSocket.on(\"sayhello\", (data) => {\r\n      console.log(\"socket connected\");\r\n    });\r\n\r\n    newSocket.emit(\"join_room\", { room: entranceRoom.id, nickName: nickName });\r\n\r\n    newSocket.on(\"all_users\", (allUsers) => {\r\n      let len = allUsers.length;\r\n      console.log(\"allUsers count: \", allUsers.length);\r\n\r\n      for (let i = 0; i < len; i++) {\r\n        createPeerConnection(\r\n          allUsers[i].id,\r\n          allUsers[i].email,\r\n          newSocket,\r\n          localStream\r\n        );\r\n        let pc = pcs[allUsers[i].id];\r\n        if (pc) {\r\n          pc.createOffer({\r\n            offerToReceiveAudio: true,\r\n            offerToReceiveVideo: true,\r\n          })\r\n            .then((sdp) => {\r\n              console.log(\"create offer success\");\r\n              pc.setLocalDescription(new RTCSessionDescription(sdp));\r\n              newSocket.emit(\"offer\", {\r\n                sdp: sdp,\r\n                offerSendID: newSocket.id,\r\n                offerSendNickName: nickName,\r\n                offerReceiveID: allUsers[i].id,\r\n              });\r\n            })\r\n            .catch((error) => {\r\n              console.log(error);\r\n            });\r\n        }\r\n      }\r\n    });\r\n\r\n    newSocket.on(\"getOffer\", (data) => {\r\n      console.log(\"getOffer\");\r\n      createPeerConnection(\r\n        data.offerSendID,\r\n        data.offerSendNickName,\r\n        newSocket,\r\n        localStream\r\n      );\r\n      let pc = pcs[data.offerSendID];\r\n      if (pc) {\r\n        pc.setRemoteDescription(new RTCSessionDescription(data.sdp))\r\n          .then(() => {\r\n            console.log(\"answer set remote description success\");\r\n            pc.createAnswer({\r\n              offerToReceiveVideo: true,\r\n              offerToReceiveAudio: true,\r\n            })\r\n              .then((sdp) => {\r\n                console.log(\"create answer success\");\r\n                pc.setLocalDescription(new RTCSessionDescription(sdp));\r\n                newSocket.emit(\"answer\", {\r\n                  sdp: sdp,\r\n                  answerSendID: newSocket.id,\r\n                  answerReceiveID: data.offerSendID,\r\n                });\r\n              })\r\n              .catch((error) => {\r\n                console.log(error);\r\n              });\r\n          })\r\n          .catch((error) => {\r\n            console.log(error);\r\n          });\r\n      }\r\n    });\r\n\r\n    newSocket.on(\"getAnswer\", (data) => {\r\n      console.log(\"getAnswer\");\r\n      let pc = pcs[data.answerSendID];\r\n      if (pc) {\r\n        pc.setRemoteDescription(new RTCSessionDescription(data.sdp));\r\n      }\r\n    });\r\n\r\n    newSocket.on(\"getCandidate\", (data) => {\r\n      console.log(\"getCandidate\");\r\n      let pc = pcs[data.candidateSendID];\r\n      if (pc) {\r\n        pc.addIceCandidate(new RTCIceCandidate(data.candidate)).then(() => {\r\n          console.log(\"candidate add success\");\r\n        });\r\n      }\r\n    });\r\n\r\n    newSocket.on(\"user_exit\", (data) => {\r\n      console.log(\"user_exit\");\r\n      pcs[data.id].close();\r\n      delete pcs[data.id];\r\n      setUsers((oldUsers) => oldUsers.filter((user) => user.id !== data.id));\r\n    });\r\n\r\n    setSocket(newSocket);\r\n  };\r\n\r\n  const createPeerConnection = (socketID, nickName, newSocket, localStream) => {\r\n    let pc = new RTCPeerConnection({\r\n      iceServers: [\r\n        {\r\n          urls: [\r\n            \"stun:stun.l.google.com:19302\",\r\n            \"stun:stun1.l.google.com:19302\",\r\n            \"stun:stun2.l.google.com:19302\",\r\n            \"stun:stun3.l.google.com:19302\",\r\n            \"stun:stun4.l.google.com:19302\",\r\n          ],\r\n        },\r\n      ],\r\n    });\r\n\r\n    pcs = { ...pcs, [socketID]: pc };\r\n\r\n    pc.onicecandidate = (e) => {\r\n      if (e.candidate) {\r\n        console.log(\"onicecandidate\");\r\n        newSocket.emit(\"candidate\", {\r\n          candidate: e.candidate,\r\n          candidateSendID: newSocket.id,\r\n          candidateReceiveID: socketID,\r\n        });\r\n      }\r\n    };\r\n\r\n    pc.oniceconnectionstatechange = (e) => {\r\n      console.log(e);\r\n    };\r\n\r\n    pc.ontrack = (e) => {\r\n      console.log(\"ontrack success\");\r\n      setUsers((oldUsers) => oldUsers.filter((user) => user.id !== socketID));\r\n      setUsers((oldUsers) => [\r\n        ...oldUsers,\r\n        {\r\n          id: socketID,\r\n          nickName: nickName,\r\n          stream: e.streams[0],\r\n        },\r\n      ]);\r\n    };\r\n\r\n    if (localStream) {\r\n      console.log(\"localStream add\");\r\n      localStream.getTracks().forEach((track) => {\r\n        pc.addTrack(track, localStream);\r\n      });\r\n    } else {\r\n      console.log(\"no local stream\");\r\n    }\r\n\r\n    return pc;\r\n  };\r\n\r\n  const onFinishClick = () => {\r\n    const ok = window.confirm(t(\"page:meeting_room:exit_confirm\"));\r\n    if (ok) {\r\n      history.push(\"/wrapup\");\r\n    }\r\n  };\r\n\r\n  const toggleMuteMode = () => {\r\n    stream\r\n      .getAudioTracks()\r\n      .forEach((track) => (track.enabled = !track.enabled));\r\n    setIsMuted((prev) => !prev);\r\n  };\r\n\r\n  const computeMessagesMode = () => {\r\n    if (getVideoCountPerRow() > 1) {\r\n      setIsMessagesSmallMode(false);\r\n    } else {\r\n      setIsMessagesSmallMode(true);\r\n    }\r\n  };\r\n\r\n  const getVideoCountPerRow = () => {\r\n    const grid = Array.from(videoWrapper.current.children);\r\n    const baseOffset = grid[0].offsetTop;\r\n    const breakIndex = grid.findIndex((item) => item.offsetTop > baseOffset);\r\n    return breakIndex === -1 ? grid.length : breakIndex;\r\n  };\r\n\r\n  return (\r\n    <Container className=\"container meeting-room-container\" maxWidth=\"md\">\r\n      <div ref={videoWrapper} className=\"video-wrapper\">\r\n        <MeetingRoomVideo nickName={nickName} stream={stream} isOwner=\"true\" />\r\n        {users.map((user, index) => {\r\n          return (\r\n            <MeetingRoomVideo\r\n              key={index}\r\n              nickName={user.nickName}\r\n              stream={user.stream}\r\n            />\r\n          );\r\n        })}\r\n      </div>\r\n      <div\r\n        className={\r\n          \"messages-wrapper \" + (isMessagesSmallMode ? \"small\" : \"large\")\r\n        }\r\n      >\r\n        <div className=\"messages-box\">\r\n          <MeetingRoomMessage\r\n            roomId={entranceRoom.id}\r\n            userId={loginedUser.uid}\r\n            userNickName={nickName}\r\n            userPhotoUrl={loginedUser.photoURL}\r\n          />\r\n        </div>\r\n      </div>\r\n      <div className=\"button-wrapper\">\r\n        <div className=\"mute\" onClick={toggleMuteMode}>\r\n          {isMuted ? <MicOffIcon /> : <MicIcon />}\r\n        </div>\r\n        <div className=\"exit\" onClick={onFinishClick}>\r\n          <NoMeetingRoomIcon />\r\n        </div>\r\n      </div>\r\n      <div className=\"error\">{error}</div>\r\n    </Container>\r\n  );\r\n};\r\n\r\nconst useScroll = () => {\r\n  const [scrollY, setScrollY] = useState(0);\r\n\r\n  const listener = () => {\r\n    setScrollY(window.pageYOffset);\r\n  };\r\n\r\n  const delay = 15;\r\n\r\n  useEffect(() => {\r\n    window.addEventListener(\"scroll\", listener);\r\n    return () => {\r\n      window.removeEventListener(\"scroll\", listener);\r\n    };\r\n  });\r\n\r\n  return {\r\n    scrollY,\r\n  };\r\n};\r\n\r\nexport default MeetingRoom;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { doc, getDoc } from \"@firebase/firestore\";\r\nimport MediaInfo from \"components/MediaInfo\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { useHistory } from \"react-router\";\r\nimport { dbService } from \"../fbase\";\r\nimport Box from \"@mui/material/Box\";\r\nimport TextField from \"@mui/material/TextField\";\r\nimport { Button, Container } from \"@mui/material\";\r\nimport { useFormik } from \"formik\";\r\nimport * as yup from \"yup\";\r\nimport { DateTime } from \"luxon\";\r\nimport AccountCircleIcon from \"@mui/icons-material/AccountCircle\";\r\nimport \"./Prepare.scss\";\r\n\r\nconst Prepare = () => {\r\n  const { t } = useTranslation([\"page\"]);\r\n  const history = useHistory();\r\n  const { uid, displayName } = useSelector((store) => store.loginedUser);\r\n\r\n  const [roomId, setRoomId] = useState(\"\");\r\n  const [room, setRoom] = useState({});\r\n  const [error, setError] = useState(\"\");\r\n  const [deviceId, setDeviceId] = useState(\"\");\r\n\r\n  const validationSchema = yup.object({\r\n    nickname: yup\r\n      .string(t(\"page:room_submit:validation:enter_nickname\"))\r\n      .max(20, t(\"page:room_submit:validation:valid_nickname\"))\r\n      .required(t(\"page:room_submit:validation:require_nickname\")),\r\n  });\r\n\r\n  const formik = useFormik({\r\n    initialValues: {\r\n      nickname: displayName ? displayName : \"\",\r\n    },\r\n    validationSchema: validationSchema,\r\n    onSubmit: (values) => {\r\n      onEntranceRoomSubmit(values.nickname);\r\n    },\r\n  });\r\n\r\n  useEffect(() => {\r\n    getRoom();\r\n  }, []);\r\n\r\n  const getRoom = async () => {\r\n    const sessionInfo = JSON.parse(\r\n      window.sessionStorage.getItem(\"sessionInfo\")\r\n    );\r\n    setRoomId(sessionInfo.entranceRoom.id);\r\n    const docRef = doc(dbService, \"rooms\", sessionInfo.entranceRoom.id);\r\n    const docSnap = await getDoc(docRef);\r\n\r\n    if (docSnap.exists()) {\r\n      setRoom(docSnap.data());\r\n    } else {\r\n      console.log(\"No such document!\");\r\n    }\r\n  };\r\n\r\n  const onEntranceRoomSubmit = async (nickname) => {\r\n    const sessionInfo = {\r\n      deviceId: deviceId,\r\n      nickName: nickname,\r\n      entranceRoom: { id: roomId, ...room },\r\n    };\r\n    window.sessionStorage.setItem(\"sessionInfo\", JSON.stringify(sessionInfo));\r\n    history.push(\"/meetingroom\");\r\n  };\r\n\r\n  const onCameraChange = (deviceId) => {\r\n    setDeviceId(deviceId);\r\n  };\r\n\r\n  return (\r\n    <Container className=\"container prepare-room-container\" maxWidth=\"xs\">\r\n      <MediaInfo onCameraChange={onCameraChange}></MediaInfo>\r\n      <Box\r\n        className=\"prepare-room-box\"\r\n        component=\"form\"\r\n        noValidate\r\n        autoComplete=\"off\"\r\n        onSubmit={formik.handleSubmit}\r\n      >\r\n        <TextField\r\n          name=\"nickname\"\r\n          label={t(\"page:prepare_room:nickname_label\")}\r\n          variant=\"standard\"\r\n          required\r\n          value={formik.values.nickname}\r\n          onChange={formik.handleChange}\r\n          error={formik.touched.nickname && Boolean(formik.errors.nickname)}\r\n          helperText={formik.touched.nickname && formik.errors.nickname}\r\n        />\r\n        <br />\r\n        <div className=\"prepare-room-info\">\r\n          <div className=\"info-item prepare-room-name\">\r\n            <span>{room.name}</span>\r\n          </div>\r\n          <div className=\"info-item prepare-room-creator\">\r\n            <span>{room.creatorNickName}</span>\r\n            {room.creatorPhotoUrl ? (\r\n              <img className=\"creator-icon\" src={room.creatorPhotoUrl} />\r\n            ) : (\r\n              <AccountCircleIcon className=\"anony creator-icon\" />\r\n            )}\r\n          </div>\r\n          <div className=\"info-item prepare-room-time\">\r\n            {DateTime.fromMillis(Number(room.createdAt)).toFormat(\r\n              \"MM/dd HH:mm\"\r\n            )}\r\n          </div>\r\n        </div>\r\n        <br />\r\n        <Button type=\"submit\" variant=\"contained\">\r\n          {t(\"page:prepare_room:entrance_room_label\")}\r\n        </Button>\r\n      </Box>\r\n      <div className=\"error\">{error}</div>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default Prepare;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport {\r\n  collection,\r\n  doc,\r\n  getDoc,\r\n  getDocs,\r\n  orderBy,\r\n  query,\r\n} from \"@firebase/firestore\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { dbService } from \"fbase\";\r\nimport { useHistory } from \"react-router\";\r\nimport { Button, Container } from \"@mui/material\";\r\nimport { DateTime } from \"luxon\";\r\nimport DirectionsRunIcon from \"@mui/icons-material/DirectionsRun\";\r\nimport CsvDownload from \"react-json-to-csv\";\r\nimport \"./Wrapup.scss\";\r\n\r\nconst Wrapup = () => {\r\n  const { t } = useTranslation([\"page\"]);\r\n  const history = useHistory();\r\n\r\n  const loginedUser = useSelector((store) => store.loginedUser);\r\n  const sessionInfo = JSON.parse(window.sessionStorage.getItem(\"sessionInfo\"));\r\n\r\n  const [error, setError] = useState(\"\");\r\n  const [startTime, setStartTime] = useState(\"\");\r\n  const [durationTime, setDurationTime] = useState(\"\");\r\n  const [roomName, setRoomName] = useState(\"\");\r\n  const [messages, setMessages] = useState([]);\r\n\r\n  useEffect(() => {\r\n    getRoom();\r\n    getMessages();\r\n  }, []);\r\n\r\n  const getRoom = async () => {\r\n    const docRef = doc(dbService, \"rooms\", sessionInfo.entranceRoom.id);\r\n    const docSnap = await getDoc(docRef);\r\n\r\n    if (docSnap.exists()) {\r\n      const diff = DateTime.now().diff(\r\n        DateTime.fromMillis(Number(docSnap.data().createdAt))\r\n      );\r\n      let durationTime = diff\r\n        .toFormat(\"dd : hh : mm : ss\")\r\n        .replace(/^[0 : ]+(?=\\d[\\d : ]{3})/, \"\");\r\n      setDurationTime(durationTime);\r\n      setStartTime(\r\n        DateTime.fromMillis(Number(docSnap.data().createdAt)).toFormat(\r\n          \"MM/dd HH:mm\"\r\n        )\r\n      );\r\n      setRoomName(docSnap.data().name);\r\n    } else {\r\n      setError(\"No such rooms\");\r\n    }\r\n  };\r\n\r\n  const getMessages = async () => {\r\n    console.log(\"getMessages\");\r\n    const messagesQuery = query(\r\n      collection(dbService, \"rooms\", sessionInfo.entranceRoom.id, \"messages\"),\r\n      orderBy(\"createdAt\", \"asc\")\r\n    );\r\n    const messageSnapshot = await getDocs(messagesQuery);\r\n    let messageArr = [];\r\n    messageSnapshot.forEach((doc) => {\r\n      messageArr.push({\r\n        nickName: doc.data().creatorNickName,\r\n        message: doc.data().message,\r\n        time: DateTime.fromMillis(Number(doc.data().createdAt)).toFormat(\r\n          \"MM/dd HH:mm\"\r\n        ),\r\n      });\r\n    });\r\n    setMessages(messageArr);\r\n  };\r\n\r\n  const onGotoLobbyClick = () => {\r\n    history.push(\"/lobby\");\r\n  };\r\n\r\n  return (\r\n    <Container className=\"container wrapup-container\" maxWidth=\"xs\">\r\n      <div className=\"wrapup-box\">\r\n        <DirectionsRunIcon className=\"run-icon\" />\r\n        <div className=\"timeline\">\r\n          <div className=\"line\"></div>\r\n        </div>\r\n        <div className=\"time-info\">\r\n          <span className=\"start-time\">{startTime}</span>\r\n          <span className=\"end-time\">\r\n            {DateTime.now().toFormat(\"MM/dd HH:mm\")}\r\n          </span>\r\n        </div>\r\n        <span className=\"duration\">{durationTime}</span>\r\n        {loginedUser.isAnonymous ? (\r\n          \"\"\r\n        ) : (\r\n          <>\r\n            <CsvDownload\r\n              className=\"btn_export_csv\"\r\n              filename={roomName + \".csv\"}\r\n              data={messages}\r\n            >\r\n              {t(\"page:wrapup:download_messages\")}\r\n            </CsvDownload>\r\n          </>\r\n        )}\r\n        <Button onClick={onGotoLobbyClick}>\r\n          {t(\"page:wrapup:goto_lobby\")}\r\n        </Button>\r\n      </div>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default Wrapup;\r\n","import React from \"react\";\r\nimport \"./NotFound.scss\";\r\n\r\nconst NotFound = () => {\r\n  return (\r\n    <div className=\"not-found\">\r\n      <div className=\"error-code\">404</div>\r\n      <div className=\"desc\">Not Found</div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NotFound;\r\n","import React from \"react\";\r\nimport { BrowserRouter, Redirect, Route, Switch } from \"react-router-dom\";\r\nimport Auth from \"routes/Auth\";\r\nimport Lobby from \"routes/Lobby\";\r\nimport CreateRoom from \"routes/CreateRoom\";\r\nimport MeetingRoom from \"routes/MeetingRoom\";\r\nimport Prepare from \"routes/Prepare\";\r\nimport Wrapup from \"routes/Wrapup\";\r\nimport NotFound from \"routes/NotFound\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { Fragment } from \"react\";\r\nimport Header from \"./Header\";\r\n\r\nexport const FragmentSupportingSwitch = ({ children }) => {\r\n  const flattenedChildren = [];\r\n  flatten(flattenedChildren, children);\r\n  return React.createElement.apply(\r\n    React,\r\n    [Switch, null].concat(flattenedChildren)\r\n  );\r\n};\r\n\r\nfunction flatten(target, children) {\r\n  React.Children.forEach(children, (child) => {\r\n    if (React.isValidElement(child)) {\r\n      if (child.type === Fragment) {\r\n        flatten(target, child.props.children);\r\n      } else {\r\n        target.push(child);\r\n      }\r\n    }\r\n  });\r\n}\r\n\r\nconst AppRouter = () => {\r\n  const loginedUser = useSelector((store) => store.loginedUser);\r\n  console.log(\"AppRouter\");\r\n\r\n  return (\r\n    <BrowserRouter basename={process.env.PUBLIC_URL}>\r\n      <Header></Header>\r\n      <FragmentSupportingSwitch>\r\n        {loginedUser ? (\r\n          <>\r\n            <Route exact path=\"/\">\r\n              <Redirect to=\"/lobby\" />\r\n            </Route>\r\n            <Route exact path=\"/lobby\">\r\n              <Lobby></Lobby>\r\n            </Route>\r\n            <Route exact path=\"/createroom\">\r\n              <CreateRoom></CreateRoom>\r\n            </Route>\r\n            <Route exact path=\"/prepare\">\r\n              <Prepare></Prepare>\r\n            </Route>\r\n            <Route exact path=\"/meetingroom\">\r\n              <MeetingRoom></MeetingRoom>\r\n            </Route>\r\n            <Route exact path=\"/wrapup\">\r\n              <Wrapup></Wrapup>\r\n            </Route>\r\n            <Route path=\"*\" component={NotFound} />\r\n          </>\r\n        ) : (\r\n          <>\r\n            <Route exact path=\"/\">\r\n              <Auth></Auth>\r\n            </Route>\r\n            <Route path=\"*\">\r\n              <Redirect to=\"/\" />\r\n            </Route>\r\n          </>\r\n        )}\r\n      </FragmentSupportingSwitch>\r\n    </BrowserRouter>\r\n  );\r\n};\r\n\r\nexport default AppRouter;\r\n","import React, { useEffect, useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { authService } from \"../fbase\";\nimport Header from \"./Header\";\nimport AppRouter from \"./Router\";\nimport LoopIcon from \"@mui/icons-material/Loop\";\nimport \"./App.scss\";\n\nfunction App() {\n  const [init, setInit] = useState(false);\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    authService.onAuthStateChanged((user) => {\n      console.log(\"onAuthStateChanged\");\n      if (user) {\n        dispatch({ type: \"AUTH_STATE_CHANGED\", user: user });\n      } else {\n        dispatch({ type: \"AUTH_STATE_CHANGED\", user: null });\n      }\n      setInit(true);\n    });\n  }, []);\n\n  return (\n    <>\n      {init ? (\n        <>\n          <AppRouter></AppRouter>\n        </>\n      ) : (\n        <div className=\"loading\">\n          <LoopIcon className=\"icon\" />\n        </div>\n      )}\n    </>\n  );\n}\n\nexport default App;\n","import page from \"./page.json\";\r\n\r\nexport default {\r\n  page,\r\n};\r\n","import i18n from \"i18next\";\r\nimport { initReactI18next } from \"react-i18next\";\r\nimport ko from \"./locales/ko\";\r\n\r\ni18n.use(initReactI18next).init({\r\n  resources: {\r\n    ko: ko,\r\n  },\r\n  lng: \"ko\",\r\n  fallbackLng: \"ko\",\r\n  ns: [\"page\"],\r\n  interpolation: {\r\n    escapeValue: false,\r\n  },\r\n});\r\n\r\nexport default i18n;\r\n","import { createStore } from \"redux\";\r\nexport default createStore((state, action) => {\r\n  if (state === undefined) {\r\n    return {\r\n      loginedUser: null,\r\n    };\r\n  }\r\n  if (action.type === \"AUTH_STATE_CHANGED\") {\r\n    return { ...state, loginedUser: action.user };\r\n  }\r\n  return state;\r\n}, window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__());\r\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"components/App\";\nimport { Provider } from \"react-redux\";\nimport \"./i18n\";\nimport \"./style.scss\";\nimport store from \"./store\";\n\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}