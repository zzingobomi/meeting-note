(this["webpackJsonpmeeting-note"]=this["webpackJsonpmeeting-note"]||[]).push([[0],{202:function(e){e.exports=JSON.parse('{"common":{"ok":"\ud655\uc778","cancel":"\ucde8\uc18c","logout":"\ub85c\uadf8\uc544\uc6c3"},"auth":{"login_with_anony":"\uc775\uba85 \ub85c\uadf8\uc778","login_with_email":"\uc774\uba54\uc77c \ub85c\uadf8\uc778","login_with_google":"\uad6c\uae00 \ub85c\uadf8\uc778","login_with_facebook":"\ud398\uc774\uc2a4\ubd81 \ub85c\uadf8\uc778"},"auth_form":{"label_email":"\uc774\uba54\uc77c","label_password":"\ube44\ubc00\ubc88\ud638","sign_in":"\ub85c\uadf8\uc778","sign_up":"\ud68c\uc6d0\uac00\uc785","validation":{"enter_email":"\uc774\uba54\uc77c\uc744 \uc785\ub825\ud574 \uc8fc\uc138\uc694","valid_email":"\uc720\ud6a8\ud55c \uc774\uba54\uc77c\uc744 \uc785\ub825\ud574 \uc8fc\uc138\uc694","require_email":"\uc774\uba54\uc77c\uc740 \ud544\uc218 \ud56d\ubaa9\uc785\ub2c8\ub2e4","enter_password":"\ube44\ubc00\ubc88\ud638\ub97c \uc785\ub825\ud574 \uc8fc\uc138\uc694","valid_password":"6\uc790\ub9ac \uc774\uc0c1\uc758 \ube44\ubc00\ubc88\ud638\ub97c \uc785\ub825\ud574 \uc8fc\uc138\uc694","require_password":"\ube44\ubc00\ubc88\ud638\ub294 \ud544\uc218 \ud56d\ubaa9\uc785\ub2c8\ub2e4"}},"lobby":{"my_room_title":"\ub0b4 \ud68c\uc758\uc2e4","other_room_title":"\ub2e4\ub978 \ud68c\uc758\uc2e4","create_room":"\ud68c\uc758\uc2e4 \ucd94\uac00"},"room_info":{"entrance":"\uc785\uc7a5\ud558\uae30"},"media_info":{"select_camera_label":"Camera"},"create_room":{"roomname_label":"\ud68c\uc758\uc2e4 \uc774\ub984","nickname_label":"\ub2c9\ub124\uc784","create_room_label":"\ub9cc\ub4e4\uae30"},"prepare_room":{"nickname_label":"\ub2c9\ub124\uc784","entrance_room_label":"\uc785\uc7a5\ud558\uae30"},"room_submit":{"validation":{"enter_roomname":"\ud68c\uc758\uc2e4 \uc774\ub984\uc744 \uc785\ub825\ud574 \uc8fc\uc138\uc694","valid_roomname":"20\uc790\ub9ac \ubbf8\ub9cc\uc758 \ud68c\uc758\uc2e4 \uc774\ub984\uc744 \uc785\ub825\ud574 \uc8fc\uc138\uc694","require_roomname":"\ud68c\uc758\uc2e4 \uc774\ub984\uc740 \ud544\uc218 \ud56d\ubaa9\uc785\ub2c8\ub2e4","enter_nickname":"\ub2c9\ub124\uc784\uc744 \uc785\ub825\ud574 \uc8fc\uc138\uc694","valid_nickname":"20\uc790\ub9ac \ubbf8\ub9cc\uc758 \ub2c9\ub124\uc784\uc744 \uc785\ub825\ud574 \uc8fc\uc138\uc694","require_nickname":"\ub2c9\ub124\uc784\uc740 \ud544\uc218 \ud56d\ubaa9\uc785\ub2c8\ub2e4"}},"wrapup":{"download_messages":"\ucc44\ud305 \ub2e4\uc6b4\ub85c\ub4dc","goto_lobby":"\ub85c\ube44\ub85c \uac00\uae30"}}')},228:function(e,t,n){},334:function(e,t,n){},335:function(e,t,n){},336:function(e,t,n){},338:function(e,t,n){},339:function(e,t,n){},340:function(e,t,n){},341:function(e,t,n){},342:function(e,t,n){},347:function(e,t,n){},348:function(e,t,n){},349:function(e,t,n){},350:function(e,t,n){},351:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),c=n(56),o=n.n(c),i=n(12),s=n(30),u=n(180),l=n(62),d=n(182),m=(Object(u.a)({apiKey:"AIzaSyB0n84bPHSynRhB1P_iWx22yKF0CLfGAKE",authDomain:"meeting-note-f1e22.firebaseapp.com",projectId:"meeting-note-f1e22",storageBucket:"meeting-note-f1e22.appspot.com",messagingSenderId:"682081837300",appId:"1:682081837300:web:857f83576a6d2127b43ea1"}),Object(l.d)()),b=Object(d.a)(),j=n(399),f=n(203),p=n(392),O=n(398),h=n(70),x=n.n(h),v=(n(228),n(2)),g=function(){var e=Object(O.a)(["page"]).t,t=Object(s.c)((function(e){return e.loginedUser})),n=Object(a.useState)(null),r=Object(i.a)(n,2),c=r[0],o=r[1],u=Boolean(c),l=function(e){o(e.currentTarget)},d=function(){o(null)};return Object(v.jsx)("header",{className:"header",children:Object(v.jsx)(j.a,{maxWidth:"lg",children:Object(v.jsxs)("div",{className:"header-container",children:[Object(v.jsx)("span",{className:"logo",children:"Meeting Note"}),Object(v.jsx)(f.a,{id:"basic-menu",anchorEl:c,open:u,onClose:d,MenuListProps:{"aria-labelledby":"basic-button"},children:Object(v.jsx)(p.a,{onClick:function(){d(),m.signOut()},children:e("page:common:logout")})}),t?Object(v.jsx)(v.Fragment,{children:t.photoURL?Object(v.jsxs)("div",{className:"user-info",children:[Object(v.jsx)("span",{children:t.displayName}),Object(v.jsx)("img",{src:t.photoURL,"aria-controls":"basic-menu","aria-haspopup":"true","aria-expanded":u?"true":void 0,onClick:l})]}):Object(v.jsx)(x.a,{className:"anony","aria-controls":"basic-menu","aria-haspopup":"true","aria-expanded":u?"true":void 0,onClick:l})}):Object(v.jsx)(v.Fragment,{})]})})})},_=n(26),k=n(139),w=n(0),N=n.n(w),y=n(4),S=n(401),C=n(393),I=n(405),T=n(86),D=n(52),E=(n(334),function(){var e=Object(O.a)(["page"]).t,t=Object(a.useState)(!1),n=Object(i.a)(t,2),r=n[0],c=n[1],o=Object(a.useState)(""),s=Object(i.a)(o,2),u=s[0],d=s[1],b=D.a({email:D.b(e("page:auth_form:validation:enter_email")).email(e("page:auth_form:validation:valid_email")).required(e("page:auth_form:validation:require_email")),password:D.b(e("page:auth_form:validation:enter_password")).min(6,e("page:auth_form:validation:valid_password")).required(e("page:auth_form:validation:require_password"))}),j=Object(T.a)({initialValues:{email:"",password:""},validationSchema:b,onSubmit:function(e){f(e.email,e.password)}}),f=function(){var e=Object(y.a)(N.a.mark((function e(t,n){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!r){e.next=7;break}return e.next=4,Object(l.c)(m,t,n);case 4:e.sent,e.next=10;break;case 7:return e.next=9,Object(l.f)(m,t,n);case 9:e.sent;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),d(e.t0.message);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t,n){return e.apply(this,arguments)}}();return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)(S.a,{className:"login-box",component:"form",noValidate:!0,autoComplete:"off",onSubmit:j.handleSubmit,children:[Object(v.jsx)(C.a,{name:"email",type:"email",label:e("page:auth_form:label_email"),variant:"standard",required:!0,value:j.values.email,onChange:j.handleChange,error:j.touched.email&&Boolean(j.errors.email),helperText:j.touched.email&&j.errors.email}),Object(v.jsx)("br",{}),Object(v.jsx)(C.a,{name:"password",type:"password",label:e("page:auth_form:label_password"),variant:"standard",required:!0,value:j.values.password,onChange:j.handleChange,error:j.touched.password&&Boolean(j.errors.password),helperText:j.touched.password&&j.errors.password}),Object(v.jsx)("br",{}),Object(v.jsx)(I.a,{type:"submit",variant:"contained",children:e(r?"page:auth_form:sign_up":"page:auth_form:sign_in")})]}),Object(v.jsx)(I.a,{className:"toggle-mode",onClick:function(){return c((function(e){return!e}))},children:e(r?"page:auth_form:sign_in":"page:auth_form:sign_up")}),Object(v.jsx)("div",{className:"error",children:u})]})}),R=n(192),A=n.n(R),M=n(193),U=n.n(M),q=(n(335),function(){var e=Object(O.a)(["page"]).t,t=Object(a.useState)(""),n=Object(i.a)(t,2),r=n[0],c=n[1],o=function(){var e=Object(y.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(l.e)(m);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),c(e.t0.message);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),s=function(){var e=Object(y.a)(N.a.mark((function e(t,n){var a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"google"===n?a=new l.b:"facebook"===n?a=new l.a:console.log("check social login type"),e.prev=1,e.next=4,Object(l.g)(m,a);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),c(e.t0.message);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t,n){return e.apply(this,arguments)}}();return Object(v.jsxs)(j.a,{className:"container login-container",maxWidth:"xs",children:[Object(v.jsx)(E,{}),Object(v.jsxs)("div",{className:"social-container",children:[Object(v.jsx)(I.a,{className:"btn-anony",variant:"contained",onClick:o,startIcon:Object(v.jsx)(x.a,{}),children:e("page:auth:login_with_anony")}),Object(v.jsx)("br",{}),Object(v.jsx)(I.a,{className:"btn-google",variant:"contained",onClick:function(e){return s(e,"google")},startIcon:Object(v.jsx)(A.a,{style:{fill:"#d50f25"}}),children:e("page:auth:login_with_google")}),Object(v.jsx)("br",{}),Object(v.jsx)(I.a,{className:"btn-facebook",variant:"contained",onClick:function(e){return s(e,"facebook")},startIcon:Object(v.jsx)(U.a,{}),children:e("page:auth:login_with_facebook")}),Object(v.jsx)("div",{className:"error",children:r})]})]})}),F=n(41),H=n(25),P=n(397),V=n(406),B=n(407),W=n(49),J=(n(336),function(e){var t=e.roomObj,n=(e.isOwner,Object(O.a)(["page"]).t,Object(_.g)());return Object(v.jsx)(V.a,{onClick:function(){var e={entranceRoom:{id:t.id}};window.sessionStorage.setItem("sessionInfo",JSON.stringify(e)),n.push("/prepare")},children:Object(v.jsxs)(B.a,{children:[Object(v.jsx)("div",{className:"room-creator-time",children:W.DateTime.fromMillis(t.createdAt).toFormat("MM/dd HH:mm")}),Object(v.jsx)("div",{className:"room-name",children:t.name}),Object(v.jsxs)("div",{className:"room-creator-info",children:[Object(v.jsx)("span",{children:t.creatorNickName}),t.creatorPhotoUrl?Object(v.jsx)("img",{src:t.creatorPhotoUrl}):Object(v.jsx)(x.a,{className:"anony"})]})]})})}),L=n(195),X=n.n(L),G=(n(338),function(){var e=Object(O.a)(["page"]).t,t=Object(_.g)(),n=Object(s.c)((function(e){return e.loginedUser})),r=Object(a.useState)([]),c=Object(i.a)(r,2),o=c[0],u=c[1];Object(a.useEffect)((function(){l()}),[]);var l=function(){var e=Object(H.j)(Object(H.b)(b,"rooms"),Object(H.i)("createdAt","desc"));Object(H.h)(e,(function(e){var t=e.docs.map((function(e){return Object(F.a)({id:e.id},e.data())}));u(t)}))};return Object(v.jsxs)(j.a,{className:"container lobby-container",maxWidth:"lg",children:[Object(v.jsx)("div",{className:"room-container-title",children:Object(v.jsx)("span",{children:e("page:lobby:my_room_title")})}),Object(v.jsxs)(P.a,{container:!0,spacing:3,justifyContent:"flex-start",alignItems:"stretch",children:[Object(v.jsx)(P.a,{item:!0,xs:12,sm:6,md:4,lg:3,children:Object(v.jsx)(V.a,{className:"btn-create-card",onClick:function(){t.push("/createroom")},children:Object(v.jsxs)(B.a,{className:"btn-create-content",children:[Object(v.jsx)(X.a,{className:"btn-create-icon"}),Object(v.jsx)("div",{className:"btn-create-label",children:e("page:lobby:create_room")})]})})}),o.filter((function(e){return e.creatorId===n.uid})).map((function(e){return Object(v.jsx)(P.a,{item:!0,xs:12,sm:6,md:4,lg:3,children:Object(v.jsx)(J,{roomObj:e,isOwner:!0},e.id)},e.id)}))]}),Object(v.jsx)("div",{className:"divider"}),Object(v.jsx)("div",{className:"room-container-title",children:Object(v.jsx)("span",{children:e("page:lobby:other_room_title")})}),Object(v.jsx)(P.a,{container:!0,spacing:3,children:o.filter((function(e){return e.creatorId!==n.uid})).map((function(e){return Object(v.jsx)(P.a,{item:!0,xs:12,sm:6,md:4,lg:3,children:Object(v.jsx)(J,{roomObj:e,isOwner:!1},e.id)},e.id)}))})]})}),z=n(394),K=n(391),Q=n(404);var Y=function(e){var t=r.a.useState(0),n=Object(i.a)(t,2),a=n[0],c=n[1],o=r.a.useRef({}),s=r.a.useCallback((function(e){o.current.audioContext&&e.data.volume&&c(Math.round(200*e.data.volume))}),[]),u=r.a.useCallback((function(){if(o.current.node)try{o.current.node.disconnect()}catch(e){}if(o.current.source)try{o.current.source.disconnect()}catch(e){}o.current.node=null,o.current.source=null,o.current.audioContext=null,c(0)}),[]),l=r.a.useCallback(function(){var e=Object(y.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o.current.audioContext&&u(),e.prev=1,o.current.audioContext=new AudioContext,e.next=5,o.current.audioContext.audioWorklet.addModule("./worklet/vumeter.js");case 5:if(o.current.audioContext){e.next=7;break}return e.abrupt("return");case 7:o.current.source=o.current.audioContext.createMediaStreamSource(t),o.current.node=new AudioWorkletNode(o.current.audioContext,"vumeter"),o.current.node.port.onmessage=s,o.current.source.connect(o.current.node).connect(o.current.audioContext.destination),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),u();case 16:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}(),[u,s]);return r.a.useEffect((function(){return c(0),e?(l(e),function(){u(e)}):function(){}}),[e,l,u]),a},Z=(n(339),function(e){var t=e.volume,n=e.max,a=void 0===n?10:n,c=e.style,o=void 0===c?{}:c,i=r.a.useMemo((function(){for(var e=[],t=100/(2*a),n=0;n<a;n+=1)e.push(Object(v.jsx)("div",{className:"volumeMeterDivider",style:{left:"".concat((2*n+1)*t,"%"),width:"".concat(t,"%")}},n));return e}),[a]);return Object(v.jsxs)("div",{className:"volumeMeter",style:o,children:[Object(v.jsx)("div",{className:"volumeMeterBg"}),Object(v.jsx)("div",{className:"volumeMeterInner",style:{transform:"scaleX(".concat(Math.ceil(t*a/100)/a,")")}}),i]})});Z.defaultProps={volume:null,max:0,style:null};var $=r.a.memo(Z,(function(e,t){return e.volume===t.volume&&e.max===t.max&&e.style===t.style})),ee=function(e){var t=e.stream,n=e.max,a=e.style,r=Y(t);return Object(v.jsx)($,{volume:r,max:n,style:a})};ee.defaultProps={stream:null,max:0,style:null};var te=r.a.memo(ee,(function(e,t){return e.stream===t.stream&&e.max===t.max&&e.style===t.style})),ne=(n(340),function(e){var t=e.stream,n=e.max,a=void 0===n?20:n,r=e.style,c=void 0===r?{}:r;return Object(v.jsx)(te,{stream:t,max:a,style:c})});ne.defaultProps={type:"AudioWorkletNode",stream:null,max:0,style:null};var ae=r.a.memo(ne,(function(e,t){return e.type===t.type&&e.stream===t.stream&&e.max===t.max&&e.style===t.style})),re=n(196),ce=n.n(re),oe=(n(341),function(e){var t=e.onCameraChange,n=Object(O.a)(["page"]).t,r=Object(a.useRef)(),c=Object(a.useState)(""),o=Object(i.a)(c,2),s=o[0],u=o[1],l=Object(a.useState)([]),d=Object(i.a)(l,2),m=d[0],b=d[1],j=Object(a.useState)(""),f=Object(i.a)(j,2),h=f[0],x=f[1],g=Object(a.useState)(null),_=Object(i.a)(g,2),k=_[0],w=_[1];Object(a.useEffect)((function(){C()}),[]),Object(a.useEffect)((function(){return function(){S()}}),[k]);var S=function(){k&&k.getTracks().forEach((function(e){e.stop()}))},C=function(){var e=Object(y.a)(N.a.mark((function e(t){var n,a,c;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={audio:!0,video:{facingMode:"user"}},a={audio:!0,video:{deviceId:{exact:t}}},e.prev=2,e.next=5,navigator.mediaDevices.getUserMedia(t?a:n);case 5:if(c=e.sent,r.current.srcObject=c,w(c),t){e.next=11;break}return e.next=11,I(c);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),u(e.t0.message);case 16:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=Object(y.a)(N.a.mark((function e(n){var a,r,c,o,i,s;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.enumerateDevices();case 3:for(a=e.sent,r=a.filter((function(e){return"videoinput"===e.kind})),c=r.map((function(e){return{value:e.deviceId,text:e.label}})),b(c),o=n.getTracks(),i=function(e){var n=o[e].getSettings().deviceId;r.forEach((function(e){n===e.deviceId&&(x(n),t(n))}))},s=0;s<o.length;s++)i(s);e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),u(e.t0.message);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(y.a)(N.a.mark((function e(n){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(n.target.value),t(n.target.value),e.next=4,C(n.target.value);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(v.jsxs)("div",{className:"media-box",children:[Object(v.jsx)("video",{className:"video-preview",ref:r,autoPlay:!0,playsInline:!0}),Object(v.jsxs)("div",{className:"mic-wrapper",children:[Object(v.jsx)(ce.a,{}),Object(v.jsx)(ae,{className:"volume-meter",stream:k,max:40})]}),Object(v.jsxs)(Q.a,{className:"select-camera",variant:"standard",children:[Object(v.jsx)(z.a,{id:"select-camera-label",children:n("page:media_info:select_camera_label")}),Object(v.jsx)(K.a,{labelId:"select-camera-label",value:h,onChange:T,label:"Camera",children:m.map((function(e){return Object(v.jsx)(p.a,{value:e.value,children:e.text},e.value)}))})]}),Object(v.jsx)("div",{className:"error",children:s})]})}),ie=(n(342),function(){var e=Object(O.a)(["page"]).t,t=Object(_.g)(),n=Object(s.c)((function(e){return e.loginedUser})),r=n.uid,c=n.displayName,o=n.photoURL,u=Object(a.useState)(""),l=Object(i.a)(u,2),d=l[0],m=l[1],f=Object(a.useState)(""),p=Object(i.a)(f,2),h=p[0],x=p[1],g=D.a({roomname:D.b(e("page:room_submit:validation:enter_roomname")).max(20,e("page:room_submit:validation:valid_roomname")).required(e("page:room_submit:validation:require_roomname")),nickname:D.b(e("page:room_submit:validation:enter_nickname")).max(20,e("page:room_submit:validation:valid_nickname")).required(e("page:room_submit:validation:require_nickname"))}),k=Object(T.a)({initialValues:{roomname:"",nickname:c},validationSchema:g,onSubmit:function(e){w(e.roomname,e.nickname)}}),w=function(){var e=Object(y.a)(N.a.mark((function e(n,a){var c,i,s;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c={name:n,creatorId:r,creatorNickName:a,creatorPhotoUrl:o,createdAt:W.DateTime.now().toMillis()},e.prev=1,e.next=4,Object(H.a)(Object(H.b)(b,"rooms"),c);case 4:i=e.sent,s={deviceId:h,nickName:a,entranceRoom:Object(F.a)({id:i.id},c)},window.sessionStorage.setItem("sessionInfo",JSON.stringify(s)),t.push("/meetingroom"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),m(e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,n){return e.apply(this,arguments)}}();return Object(v.jsxs)(j.a,{className:"container create-room-container",maxWidth:"xs",children:[Object(v.jsx)(oe,{onCameraChange:function(e){x(e)}}),Object(v.jsxs)(S.a,{className:"create-room-box",component:"form",noValidate:!0,autoComplete:"off",onSubmit:k.handleSubmit,children:[Object(v.jsx)(C.a,{name:"roomname",label:e("page:create_room:roomname_label"),variant:"standard",required:!0,value:k.values.roomname,onChange:k.handleChange,error:k.touched.roomname&&Boolean(k.errors.roomname),helperText:k.touched.roomname&&k.errors.roomname}),Object(v.jsx)("br",{}),Object(v.jsx)(C.a,{name:"nickname",label:e("page:create_room:nickname_label"),variant:"standard",required:!0,value:k.values.nickname,onChange:k.handleChange,error:k.touched.nickname&&Boolean(k.errors.nickname),helperText:k.touched.nickname&&k.errors.nickname}),Object(v.jsx)("br",{}),Object(v.jsx)(I.a,{type:"submit",variant:"contained",children:e("page:create_room:create_room_label")})]}),Object(v.jsx)("div",{className:"error",children:d})]})}),se=n(17),ue=n(6),le=n(204),de=(n(347),function(e){var t=e.nickName,n=e.stream,r=e.muted,c=Object(a.useRef)(null),o=Object(a.useState)(!1),s=Object(i.a)(o,2),u=s[0],l=s[1];return Object(a.useEffect)((function(){c.current&&(c.current.srcObject=n),r&&l(r)}),[n,r]),Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("video",{ref:c,muted:u,autoPlay:!0}),Object(v.jsx)("span",{children:t})]})}),me=function(){var e,t,n,r=Object(s.c)((function(e){return e.loginedUser})),c=JSON.parse(window.sessionStorage.getItem("sessionInfo")),o=Object(_.g)(),u=Object(a.useState)(""),l=Object(i.a)(u,2),d=(l[0],l[1]),m=Object(a.useState)(c.deviceId),f=Object(i.a)(m,2),p=f[0],O=(f[1],Object(a.useState)(c.nickName)),h=Object(i.a)(O,2),x=h[0],g=(h[1],Object(a.useState)(c.entranceRoom)),k=Object(i.a)(g,2),w=k[0],S=(k[1],Object(a.useState)([])),C=Object(i.a)(S,2),I=(C[0],C[1],Object(a.useState)("")),T=Object(i.a)(I,2),D=(T[0],T[1],Object(a.useState)("")),E=Object(i.a)(D,2),R=E[0],A=E[1],M=Object(a.useRef)(),U=Object(a.useState)(null),q=Object(i.a)(U,2),P=q[0],V=q[1],B=Object(a.useState)(),W=Object(i.a)(B,2),J=W[0],L=W[1],X=Object(a.useState)([]),G=Object(i.a)(X,2),z=G[0],K=G[1];Object(a.useEffect)((function(){return Q(),function(){Y()}}),[]),Object(a.useEffect)((function(){return function(){Z()}}),[P]);var Q=function(){var e=Object(y.a)(N.a.mark((function e(){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$(p);case 2:ee();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Y=function(){J&&J.close()},Z=function(){P&&P.getTracks().forEach((function(e){e.stop()}))},$=function(){var t=Object(y.a)(N.a.mark((function t(n){var a;return N.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={audio:!0,video:{deviceId:{exact:n}}},t.prev=1,t.next=4,navigator.mediaDevices.getUserMedia(a);case 4:e=t.sent,M.current.srcObject=e,V(e),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),d(t.t0.message);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}(),ee=function(){console.log("handleSocket"),(t=Object(le.a)("https://node.zzingobomi.synology.me")).on("sayhello",(function(e){A(e)})),t.emit("join_room",{room:w.id,nickName:x}),t.on("all_users",(function(a){console.log("allUsers");for(var r=a.length,c=function(r){te(a[r].id,a[r].email,t,e);var c=n[a[r].id];c&&c.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0}).then((function(e){console.log("create offer success"),c.setLocalDescription(new RTCSessionDescription(e)),t.emit("offer",{sdp:e,offerSendID:t.id,offerSendNickName:x,offerReceiveID:a[r].id})})).catch((function(e){console.log(e)}))},o=0;o<r;o++)c(o)})),t.on("getOffer",(function(a){console.log("getOffer"),te(a.offerSendID,a.offerSendNickName,t,e);var r=n[a.offerSendID];r&&r.setRemoteDescription(new RTCSessionDescription(a.sdp)).then((function(){console.log("answer set remote description success"),r.createAnswer({offerToReceiveVideo:!0,offerToReceiveAudio:!0}).then((function(e){console.log("create answer success"),r.setLocalDescription(new RTCSessionDescription(e)),t.emit("answer",{sdp:e,answerSendID:t.id,answerReceiveID:a.offerSendID})})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}))})),t.on("getAnswer",(function(e){console.log("getAnswer");var t=n[e.answerSendID];t&&t.setRemoteDescription(new RTCSessionDescription(e.sdp))})),t.on("getCandidate",(function(e){console.log("getCandidate");var t=n[e.candidateSendID];t&&t.addIceCandidate(new RTCIceCandidate(e.candidate)).then((function(){console.log("candidate add success")}))})),t.on("user_exit",(function(e){console.log("user_exit"),n[e.id].close(),delete n[e.id],K((function(t){return t.filter((function(t){return t.id!==e.id}))}))})),L(t)},te=function(e,t,a,r){var c=new RTCPeerConnection({iceServers:[{urls:["stun:stun.l.google.com:19302","stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302","stun:stun3.l.google.com:19302","stun:stun4.l.google.com:19302"]}]});return n=Object(F.a)(Object(F.a)({},n),{},Object(ue.a)({},e,c)),c.onicecandidate=function(t){t.candidate&&(console.log("onicecandidate"),a.emit("candidate",{candidate:t.candidate,candidateSendID:a.id,candidateReceiveID:e}))},c.oniceconnectionstatechange=function(e){console.log(e)},c.ontrack=function(n){console.log("ontrack success"),K((function(t){return t.filter((function(t){return t.id!==e}))})),K((function(a){return[].concat(Object(se.a)(a),[{id:e,nickName:t,stream:n.streams[0]}])}))},r?(console.log("localStream add"),r.getTracks().forEach((function(e){c.addTrack(e,r)}))):console.log("no local stream"),c},ne=function(){var e=Object(y.a)(N.a.mark((function e(){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(w.creatorId!==r.uid){e.next=3;break}return e.next=3,Object(H.c)(Object(H.d)(b,"rooms/".concat(w.id)));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(v.jsxs)(j.a,{className:"container meeting-room-container",maxWidth:"lg",children:[Object(v.jsxs)("p",{children:["socket response: ",R]}),Object(v.jsx)("video",{ref:M,autoPlay:!0,playsInline:!0}),z.map((function(e,t){return Object(v.jsx)(de,{nickName:e.nickName,stream:e.stream},t)})),Object(v.jsx)("br",{}),Object(v.jsx)("br",{}),Object(v.jsx)("button",{onClick:function(){P.getAudioTracks().forEach((function(e){return e.enabled=!e.enabled}))},children:"\uc74c\uc18c\uac70"}),Object(v.jsx)("button",{onClick:function(){window.confirm("\uc815\ub9d0 \ud68c\uc758\uc2e4\uc744 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")&&(ne(),o.push("/lobby"))},children:"\ubc29\uc0ad\uc81c"}),Object(v.jsx)("button",{onClick:function(){window.confirm("\uc815\ub9d0 \ud68c\uc758\ub97c \uc885\ub8cc\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")&&o.push("/wrapup")},children:"\ud68c\uc758\uc885\ub8cc"})]})},be=(n(348),function(){var e=Object(O.a)(["page"]).t,t=Object(_.g)(),n=Object(s.c)((function(e){return e.loginedUser})),r=(n.uid,n.displayName,Object(a.useState)("")),c=Object(i.a)(r,2),o=c[0],u=c[1],l=Object(a.useState)({}),d=Object(i.a)(l,2),m=d[0],f=d[1],p=Object(a.useState)(""),h=Object(i.a)(p,2),g=h[0],k=(h[1],Object(a.useState)("")),w=Object(i.a)(k,2),E=w[0],R=w[1],A=D.a({nickname:D.b(e("page:room_submit:validation:enter_nickname")).max(20,e("page:room_submit:validation:valid_nickname")).required(e("page:room_submit:validation:require_nickname"))}),M=Object(T.a)({initialValues:{nickname:"test"},validationSchema:A,onSubmit:function(e){q(e.nickname)}});Object(a.useEffect)((function(){U()}),[]);var U=function(){var e=Object(y.a)(N.a.mark((function e(){var t,n,a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=JSON.parse(window.sessionStorage.getItem("sessionInfo")),u(t.entranceRoom.id),n=Object(H.d)(b,"rooms",t.entranceRoom.id),e.next=5,Object(H.e)(n);case 5:(a=e.sent).exists()?f(a.data()):console.log("No such document!");case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),q=function(){var e=Object(y.a)(N.a.mark((function e(n){var a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a={deviceId:E,nickName:n,entranceRoom:Object(F.a)({id:o},m)},window.sessionStorage.setItem("sessionInfo",JSON.stringify(a)),t.push("/meetingroom");case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(v.jsxs)(j.a,{className:"container prepare-room-container",maxWidth:"xs",children:[Object(v.jsx)(oe,{onCameraChange:function(e){R(e)}}),Object(v.jsxs)(S.a,{className:"prepare-room-box",component:"form",noValidate:!0,autoComplete:"off",onSubmit:M.handleSubmit,children:[Object(v.jsx)(C.a,{name:"nickname",label:e("page:prepare_room:nickname_label"),variant:"standard",required:!0,value:M.values.nickname,onChange:M.handleChange,error:M.touched.nickname&&Boolean(M.errors.nickname),helperText:M.touched.nickname&&M.errors.nickname}),Object(v.jsx)("br",{}),Object(v.jsxs)("div",{className:"prepare-room-info",children:[Object(v.jsx)("div",{className:"info-item prepare-room-name",children:Object(v.jsx)("span",{children:m.name})}),Object(v.jsxs)("div",{className:"info-item prepare-room-creator",children:[Object(v.jsx)("span",{children:m.creatorNickName}),m.creatorPhotoUrl?Object(v.jsx)("img",{className:"creator-icon",src:m.creatorPhotoUrl}):Object(v.jsx)(x.a,{className:"anony creator-icon"})]}),Object(v.jsx)("div",{className:"info-item prepare-room-time",children:W.DateTime.fromMillis(Number(m.createdAt)).toFormat("MM/dd HH:mm")})]}),Object(v.jsx)("br",{}),Object(v.jsx)(I.a,{type:"submit",variant:"contained",children:e("page:prepare_room:entrance_room_label")})]}),Object(v.jsx)("div",{className:"error",children:g})]})}),je=n(200),fe=n.n(je),pe=(n(349),function(){var e=Object(O.a)(["page"]).t,t=Object(_.g)(),n=Object(s.c)((function(e){return e.loginedUser})),r=JSON.parse(window.sessionStorage.getItem("sessionInfo")),c=Object(a.useState)(""),o=Object(i.a)(c,2),u=(o[0],o[1]),l=Object(a.useState)(""),d=Object(i.a)(l,2),m=d[0],f=d[1],p=Object(a.useState)(""),h=Object(i.a)(p,2),x=h[0],g=h[1],k=[],w=Object(a.useRef)();Object(a.useEffect)((function(){S()}),[]);var S=function(){var e=Object(y.a)(N.a.mark((function e(){var t,n,a,c;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object(H.d)(b,"rooms",r.entranceRoom.id),e.next=3,Object(H.e)(t);case 3:(n=e.sent).exists()?(a=W.DateTime.now().diff(W.DateTime.fromMillis(Number(n.data().createdAt))),c=a.toFormat("dd : hh : mm : ss").replace(/^[0 : ]+(?=\d[\d : ]{3})/,""),g(c),f(W.DateTime.fromMillis(Number(n.data().createdAt)).toFormat("MM/dd HH:mm"))):u("No such rooms");case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),C=function(){var e=Object(y.a)(N.a.mark((function e(){var t;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("getMessages"),t=Object(H.j)(Object(H.b)(b,"rooms",r.entranceRoom.id,"messages"),Object(H.i)("createdAt","asc")),e.next=4,Object(H.f)(t);case 4:e.sent.forEach((function(e){k.push(e.data())}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),T=function(){var e="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(k));w.current.setAttribute("href",e),w.current.setAttribute("download","messages.json"),w.current.click()},D=function(){var e=Object(y.a)(N.a.mark((function e(){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C();case 2:T();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(v.jsx)(j.a,{className:"container wrapup-container",maxWidth:"xs",children:Object(v.jsxs)("div",{className:"time-box",children:[Object(v.jsx)(fe.a,{className:"run-icon"}),Object(v.jsx)("div",{className:"timeline",children:Object(v.jsx)("div",{className:"line"})}),Object(v.jsxs)("div",{className:"time-info",children:[Object(v.jsx)("span",{className:"start-time",children:m}),Object(v.jsx)("span",{className:"end-time",children:W.DateTime.now().toFormat("MM/dd HH:mm")})]}),Object(v.jsx)("span",{className:"duration",children:x}),n.isAnonymous?"":Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("a",{ref:w,style:{display:"none"}}),Object(v.jsx)(I.a,{onClick:D,children:e("page:wrapup:download_messages")})]}),Object(v.jsx)(I.a,{onClick:function(){t.push("/lobby")},children:e("page:wrapup:goto_lobby")})]})})}),Oe=function(){return Object(v.jsx)("div",{children:"NotFound"})},he=function(e){var t=[];return xe(t,e.children),r.a.createElement.apply(r.a,[_.d,null].concat(t))};function xe(e,t){r.a.Children.forEach(t,(function(t){r.a.isValidElement(t)&&(t.type===a.Fragment?xe(e,t.props.children):e.push(t))}))}var ve=function(){var e=Object(s.c)((function(e){return e.loginedUser}));return console.log("AppRouter"),Object(v.jsx)(k.a,{basename:"/meeting-note",children:Object(v.jsx)(he,{children:e?Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(_.b,{exact:!0,path:"/",children:Object(v.jsx)(_.a,{to:"/lobby"})}),Object(v.jsx)(_.b,{exact:!0,path:"/lobby",children:Object(v.jsx)(G,{})}),Object(v.jsx)(_.b,{exact:!0,path:"/createroom",children:Object(v.jsx)(ie,{})}),Object(v.jsx)(_.b,{exact:!0,path:"/prepare",children:Object(v.jsx)(be,{})}),Object(v.jsx)(_.b,{exact:!0,path:"/meetingroom",children:Object(v.jsx)(me,{})}),Object(v.jsx)(_.b,{exact:!0,path:"/wrapup",children:Object(v.jsx)(pe,{})}),Object(v.jsx)(_.b,{path:"*",component:Oe})]}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(_.b,{exact:!0,path:"/",children:Object(v.jsx)(q,{})}),Object(v.jsx)(_.b,{path:"*",children:Object(v.jsx)(_.a,{to:"/"})})]})})})};var ge=function(){var e=Object(a.useState)(!1),t=Object(i.a)(e,2),n=t[0],r=t[1],c=Object(s.b)();return Object(a.useEffect)((function(){m.onAuthStateChanged((function(e){console.log("onAuthStateChanged"),c(e?{type:"AUTH_STATE_CHANGED",user:e}:{type:"AUTH_STATE_CHANGED",user:null}),r(!0)}))}),[]),Object(v.jsx)(v.Fragment,{children:n?Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(g,{}),Object(v.jsx)(ve,{})]}):"loading..."})},_e=n(146),ke=n(102),we={page:n(202)};_e.a.use(ke.e).init({resources:{ko:we},lng:"ko",fallbackLng:"ko",ns:["page"],interpolation:{escapeValue:!1}});_e.a,n(350);var Ne=n(206),ye=Object(Ne.a)((function(e,t){return void 0===e?{loginedUser:null}:"AUTH_STATE_CHANGED"===t.type?Object(F.a)(Object(F.a)({},e),{},{loginedUser:t.user}):e}),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());o.a.render(Object(v.jsx)(s.a,{store:ye,children:Object(v.jsx)(ge,{})}),document.getElementById("root"))}},[[351,1,2]]]);
//# sourceMappingURL=main.a56a1ca1.chunk.js.map